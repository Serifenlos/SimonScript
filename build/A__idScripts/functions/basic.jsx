function GetFileNameOnly(e){var t=e.lastIndexOf(".");return-1==t?e:e.substr(0,t)}function SmartObject_edit(){var e=new ActionDescriptor;executeAction(sTID("placedLayerEditContents"),e,DialogModes.NO)}function SmartOject_placeItem(e){var t=new ActionDescriptor;t.putPath(cTID("null"),new File(e)),executeAction(sTID("placedLayerReplaceContents"),t,DialogModes.NO)}// CleanSL
function c2t(e){return app.charIDToTypeID(e)}// xtools
function cTID(e){return app.charIDToTypeID(e)}// CleanSL
function s2t(e){return app.stringIDToTypeID(e)}// xtools
function sTID(e){return app.stringIDToTypeID(e)}// CleanSL
function t2s(e){return app.typeIDToStringID(e)}function adjustLayer_levels_autoLevels(e,t){
/* reset levels */
adjustLayer_levels_edit(null);
/* set autoLevels option */
var n=new ActionDescriptor,r=new ActionDescriptor,o=new ActionDescriptor,i=new ActionList,s=new ActionReference,c=new ActionReference;s.putEnumerated(s2t("adjustmentLayer"),s2t("ordinal"),s2t("targetEnum")),n.putReference(s2t("null"),s),c.putEnumerated(s2t("channel"),s2t("channel"),s2t("composite")),o.putReference(s2t("channel"),c),"autoContrast"==e&&o.putBoolean(s2t("autoContrast"),!0),"auto"==e&&o.putBoolean(s2t("auto"),!0),"autoBlackWhite"==e&&o.putBoolean(s2t("autoBlackWhite"),!0),"autoMachineLearning"==e&&(o.putBoolean(s2t("autoMachineLearning"),!0),o.putBoolean(s2t("autoFaces"),!0)),t&&o.putBoolean(s2t("autoNeutrals"),t),i.putObject(s2t("levelsAdjustment"),o),r.putList(s2t("adjustment"),i),n.putObject(s2t("to"),s2t("levels"),r),executeAction(s2t("set"),n,DialogModes.NO)}function adjustLayer_levels_autoLevels_wrapper(e,t){var n=layer_selectedIDX_get();"LayerKind.LEVELS"==doc.activeLayer.kind?
// alert("ding")
makeVisible():layer_checkExistence("AutoTonwert")?(gotoLayer("AutoTonwert"),makeVisible()):alert("keine TonWert-Ebene ausgewählt bzw vorbereitet"),adjustLayer_levels_autoLevels(e,t),layer_selectedIDX_set(n)}function adjustLayer_levels_edit(e,t,n,r,o,i,t,s,c,a,u,l,p,D,I,d,T,f,g,m){var A=new ActionDescriptor,v=new ActionDescriptor,y=new ActionDescriptor,h=new ActionDescriptor,w=new ActionDescriptor,E=new ActionDescriptor,R=new ActionList,b=new ActionList,L=new ActionList,M=new ActionList,O=new ActionList,S=new ActionList,N=new ActionList,x=new ActionList,C=new ActionList,B=new ActionReference,P=new ActionReference,k=new ActionReference,j=new ActionReference,U=new ActionReference;null==e&&(e=0),null==t&&(t=255),null==n&&(n=0),null==r&&(r=255),null==o&&(o=1),null==i&&(i=0),null==t&&(t=255),null==s&&(s=0),null==c&&(c=255),null==a&&(a=1),null==u&&(u=0),null==l&&(l=255),null==p&&(p=0),null==D&&(D=255),null==I&&(I=1),null==d&&(d=0),null==T&&(T=255),null==f&&(f=0),null==g&&(g=255),null==m&&(m=1),B.putEnumerated(s2t("adjustmentLayer"),s2t("ordinal"),s2t("targetEnum")),A.putReference(s2t("null"),B),v.putEnumerated(s2t("presetKind"),s2t("presetKindType"),s2t("presetKindDefault")),P.putEnumerated(s2t("channel"),s2t("channel"),s2t("composite")),y.putReference(s2t("channel"),P),b.putInteger(e),b.putInteger(t),y.putList(s2t("input"),b),y.putDouble(s2t("gamma"),o),L.putInteger(n),L.putInteger(r),y.putList(s2t("output"),L),R.putObject(s2t("levelsAdjustment"),y),k.putEnumerated(s2t("channel"),s2t("channel"),s2t("red")),h.putReference(s2t("channel"),k),M.putInteger(i),M.putInteger(t),h.putList(s2t("input"),M),h.putDouble(s2t("gamma"),a),O.putInteger(s),O.putInteger(c),h.putList(s2t("output"),O),R.putObject(s2t("levelsAdjustment"),h),j.putEnumerated(s2t("channel"),s2t("channel"),s2t("grain")),w.putReference(s2t("channel"),j),S.putInteger(u),S.putInteger(l),w.putList(s2t("input"),S),w.putDouble(s2t("gamma"),I),N.putInteger(p),N.putInteger(D),w.putList(s2t("output"),N),R.putObject(s2t("levelsAdjustment"),w),U.putEnumerated(s2t("channel"),s2t("channel"),s2t("blue")),E.putReference(s2t("channel"),U),x.putInteger(d),x.putInteger(T),E.putList(s2t("input"),x),E.putDouble(s2t("gamma"),m),C.putInteger(f),C.putInteger(g),E.putList(s2t("output"),C),R.putObject(s2t("levelsAdjustment"),E),v.putList(s2t("adjustment"),R),A.putObject(s2t("to"),s2t("levels"),v),executeAction(s2t("set"),A,DialogModes.NO)}function app_getForegroundColor(){var e=[],t=app.foregroundColor;return e.push(Math.round(t.rgb.red)),e.push(Math.round(t.rgb.green)),e.push(Math.round(t.rgb.blue)),e}function assignProfile(e){var t=new ActionDescriptor,n=new ActionReference;n.putEnumerated(sTID("document"),sTID("ordinal"),sTID("targetEnum")),t.putReference(sTID("null"),n),t.putString(sTID("profile"),e),executeAction(sTID("assignProfile"),t,DialogModes.NO)}// function blendif(_blackMin, _blackMax, _whiteMin, _whiteMax) {
//     var d = new ActionDescriptor();
//     var r = new ActionReference();
//     r.putEnumerated(sTID('layer'), sTID('ordinal'), sTID('targetEnum'));
//     d.putReference(sTID('null'), r);
//     var d2 = new ActionDescriptor();
//     var l = new ActionList();
//     var d3 = new ActionDescriptor();
//     var r2 = new ActionReference();
//     r2.putEnumerated(sTID('channel'), sTID('channel'), sTID('gray'));
//     d3.putReference(sTID('channel'), r2);
//     d3.putInteger(sTID('srcBlackMin'), 0);
//     d3.putInteger(sTID('srcBlackMax'), 0);
//     d3.putInteger(sTID('srcWhiteMin'), 255);
//     d3.putInteger(sTID('srcWhiteMax'), 255);
//     d3.putInteger(sTID('destBlackMin'), _blackMin);
//     d3.putInteger(sTID('destBlackMax'), _blackMax);
//     d3.putInteger(sTID('destWhiteMin'), _whiteMin);
//     d3.putInteger(sTID('desaturate'), _whiteMax);
//     l.putObject(sTID('blendRange'), d3);
//     d2.putList(sTID('blendRange'), l);
//     var d4 = new ActionDescriptor();
//     d4.putUnitDouble(sTID('scale'), sTID('percentUnit'), 100.000000);
//     d2.putObject(sTID('layerEffects'), sTID('layerEffects'), d4);
//     d.putObject(sTID('to'), sTID('layer'), d2);
//     executeAction(sTID('set'), d, DialogModes.NO);
// }
function blendif(e,t,n,r,o){var i=new ActionDescriptor,s=new ActionReference;isNaN(e)?s.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("targetEnum")):s.putIndex(s2t("layer"),e),i.putReference(sTID("null"),s);var c=new ActionDescriptor,a=new ActionList,u=new ActionDescriptor,l=new ActionReference;l.putEnumerated(sTID("channel"),sTID("channel"),sTID("gray")),u.putReference(sTID("channel"),l),u.putInteger(sTID("srcBlackMin"),0),u.putInteger(sTID("srcBlackMax"),0),u.putInteger(sTID("srcWhiteMin"),255),u.putInteger(sTID("srcWhiteMax"),255),u.putInteger(sTID("destBlackMin"),t),u.putInteger(sTID("destBlackMax"),n),u.putInteger(sTID("destWhiteMin"),r),u.putInteger(sTID("desaturate"),o),a.putObject(sTID("blendRange"),u),c.putList(sTID("blendRange"),a),i.putObject(sTID("to"),sTID("layer"),c),executeAction(sTID("set"),i,DialogModes.NO)}function checkTransparency(){return doc.suspendHistory("Transparent Check","checkTransparency_inner()"),undoSteps(1),!!transp}function checkTransparency_inner(){prefSave(),transp=!0;var e=function(e){return app.stringIDToTypeID(e)},t=new ActionDescriptor,n=new ActionDescriptor,r=new ActionReference,o=new ActionReference,i=new ActionReference;r.putProperty(e("channel"),e("selection")),t.putReference(e("null"),r),o.putEnumerated(e("channel"),e("channel"),e("transparencyEnum")),o.putEnumerated(e("layer"),e("ordinal"),e("merged")),n.putReference(e("to"),o),i.putEnumerated(e("channel"),e("channel"),e("transparencyEnum")),i.putEnumerated(e("layer"),e("ordinal"),e("merged")),n.putReference(e("source2"),i),t.putObject(e("to"),e("calculation"),n);try{executeAction(e("set"),t,DialogModes.NO),activeDocument.selection.invert();try{activeDocument.selection.bounds}catch(e){transp=!1}}catch(e){transp=!1}return prefReset(),activeDocument.selection.deselect(),transp}function clearAllGuides(){executeAction(sTID("clearAllGuides"),void 0,DialogModes.NO)}function cm2pt(e){return 28.3464566929*e}function cmyk2rgb(){doc.mode==DocumentMode.CMYK&&doc.convertProfile("eciRGB v2",Intent.RELATIVECOLORIMETRIC,!0,!1)}// Apfel c
function copy(){executeAction(cTID("copy"),void 0,DialogModes.NO)}function createColorLayer(e,t,n,r,o,i,s,c){try{var a=new ActionDescriptor,u=new ActionReference;u.putClass(sTID("contentLayer")),a.putReference(sTID("null"),u);var l=new ActionDescriptor;l.putString(sTID("name"),e),l.putUnitDouble(sTID("opacity"),sTID("percentUnit"),r),l.putEnumerated(sTID("mode"),sTID("blendMode"),sTID(t)),l.putEnumerated(sTID("color"),sTID("color"),sTID(n));var p=new ActionDescriptor,D=new ActionDescriptor;if(D.putDouble(sTID("red"),i),D.putDouble(sTID("green"),s),D.putDouble(sTID("blue"),c),p.putObject(sTID("color"),sTID("RGBColor"),D),l.putObject(sTID("type"),sTID("solidColorLayer"),p),a.putObject(sTID("using"),sTID("contentLayer"),l),executeAction(sTID("make"),a,DialogModes.NO),gotoMask(),"invert"==o)return void executeAction(sTID("invert"),void 0,DialogModes.NO);if("none"==o)return void deleteMask();if("black"==o||"white"==o||"gray"==o)return void fill(o,"normal",100)}catch(e){logger(arguments.callee.name)}}function createGroup(e,t,n,r,o){try{var i=new ActionDescriptor,s=new ActionReference;if(s.putClass(sTID("layerSection")),i.putReference(sTID("null"),s),o){var c=new ActionReference;c.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("targetEnum")),i.putReference(sTID("from"),c)}var a=new ActionDescriptor;a.putString(sTID("name"),e),a.putUnitDouble(sTID("opacity"),sTID("percentUnit"),r),a.putEnumerated(sTID("color"),sTID("color"),sTID(n)),a.putEnumerated(sTID("mode"),sTID("blendMode"),sTID(t)),i.putObject(sTID("using"),sTID("layerSection"),a),i.putInteger(sTID("layerSectionStart"),351),i.putInteger(sTID("layerSectionEnd"),352),i.putString(sTID("name"),"Gruppe 3"),executeAction(sTID("make"),i,DialogModes.NO)}catch(e){logger(arguments.callee.name)}}function createLayer(e,t,n,r,o,i,s,c){try{var a=new ActionDescriptor,u=new ActionReference;u.putClass(sTID("adjustmentLayer")),a.putReference(sTID("null"),u);var l=new ActionDescriptor;if(l.putString(sTID("name"),e),l.putUnitDouble(sTID("opacity"),sTID("percentUnit"),o),l.putEnumerated(sTID("mode"),sTID("blendMode"),sTID(n)),l.putEnumerated(sTID("color"),sTID("color"),sTID(r)),l.putBoolean(sTID("group"),s),"levels"==t&&c){var p=new ActionDescriptor;p.putEnumerated(sTID("presetKind"),sTID("presetKindType"),sTID("presetKindDefault"));var D=new ActionList,I=new ActionDescriptor,d=new ActionReference;d.putEnumerated(sTID("channel"),sTID("channel"),sTID("composite")),I.putReference(sTID("channel"),d),I.putBoolean(sTID("auto"),!0),D.putObject(sTID("levelsAdjustment"),I),p.putList(sTID("adjustment"),D),l.putObject(sTID("type"),sTID(t),p)}else l.putClass(sTID("type"),sTID(t));if(a.putObject(sTID("using"),sTID("adjustmentLayer"),l),executeAction(sTID("make"),a,DialogModes.NO),"invert"==i)return void executeAction(sTID("invert"),void 0,DialogModes.NO);if("none"==i)return void deleteMask();if("black"==i||"white"==i||"gray"==i)return void fill(i,"normal",100)}catch(e){logger(arguments.callee.name)}}function createMask(){var e=new ActionDescriptor,t=new ActionReference;e.putClass(s2t("new"),s2t("channel")),t.putEnumerated(s2t("channel"),s2t("channel"),s2t("mask")),e.putReference(s2t("at"),t),e.putEnumerated(s2t("using"),c2t("UsrM"),s2t("revealAll")),executeAction(s2t("make"),e,DialogModes.NO)}function deleteHistory(){var e=new ActionDescriptor,t=new ActionReference;t.putProperty(charIDToTypeID("HstS"),charIDToTypeID("CrnH")),e.putReference(charIDToTypeID("null"),t),executeAction(charIDToTypeID("Dlt "),e,DialogModes.NO)}function deleteMask(){try{var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("channel"),sTID("channel"),sTID("mask")),e.putReference(sTID("null"),t),executeAction(sTID("delete"),e,DialogModes.NO)}catch(e){logger(arguments.callee.name)}}function dublicate(e){var t=new ActionDescriptor,n=new ActionReference;n.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("targetEnum")),t.putReference(sTID("null"),n),t.putString(sTID("name"),e),t.putInteger(sTID("version"),5),executeAction(sTID("duplicate"),t,DialogModes.NO)}function emptyProtocoll(){var e=new ActionDescriptor;e.putEnumerated(cTID("null"),cTID("PrgI"),cTID("Al  ")),executeAction(cTID("Prge"),e,DialogModes.NO);for(var t=app.activeDocument.historyStates,n=t.length-1;n>=0;--n)t[n].snapshot&&(app.activeDocument.activeHistoryState=t[n],deleteHistory())}function fill(e,t,n,r,o,i){try{var s=new ActionDescriptor;if(s.putEnumerated(sTID("using"),sTID("fillContents"),sTID(e)),"color"==e){var c=new ActionDescriptor;c.putUnitDouble(sTID("hue"),sTID("angleUnit"),r),c.putDouble(sTID("saturation"),o),c.putDouble(sTID("brightness"),i),s.putObject(sTID("color"),sTID("HSBColorClass"),c)}s.putUnitDouble(sTID("opacity"),sTID("percentUnit"),n),s.putEnumerated(sTID("mode"),sTID("blendMode"),sTID(t)),executeAction(sTID("fill"),s,DialogModes.NO)}catch(e){logger(arguments.callee.name)}}function flattenImage(){executeAction(charIDToTypeID("FltI"),void 0,DialogModes.NO)}function getBitDepth(){if("BitsPerChannelType.EIGHT"==doc.bitsPerChannel)var e=8;else if(doc.bitsPerChannel==BitsPerChannelType.SIXTEEN)e=16;else{if(doc.bitsPerChannel!=BitsPerChannelType.THIRTYTWO)return!1;e=32}return e}function getScale(e){var t=1e6*e/(doc.width*doc.height);return Math.sqrt(t)}function gotoFill(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("channel"),sTID("channel"),sTID("RGB")),e.putReference(sTID("null"),t),e.putBoolean(sTID("makeVisible"),!1),executeAction(sTID("select"),e,DialogModes.NO)}function gotoLayer(e){var t=new ActionDescriptor,n=new ActionReference;"number"==typeof e?n.putIndex(charIDToTypeID("Lyr "),e):"string"==typeof e&&n.putName(sTID("layer"),e),t.putReference(sTID("null"),n),t.putBoolean(sTID("makeVisible"),!1),executeAction(sTID("select"),t,DialogModes.NO)}function gotoMask(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("channel"),sTID("channel"),sTID("mask")),e.putReference(sTID("null"),t),e.putBoolean(sTID("makeVisible"),!1),executeAction(sTID("select"),e,DialogModes.NO)}function gray2rgb(){doc.mode==DocumentMode.GRAYSCALE&&doc.convertProfile("eciRGB v2",Intent.RELATIVECOLORIMETRIC,!0,!1)}function hasBackground(){var e=new ActionReference;return e.putProperty(charIDToTypeID("Prpr"),charIDToTypeID("Bckg")),e.putEnumerated(charIDToTypeID("Lyr "),charIDToTypeID("Ordn"),charIDToTypeID("Back")),executeActionGet(e).getBoolean(charIDToTypeID("Bckg"))}function img_resize(e,t){var n;(prefSave(),prefSet(DialogModes.NO,Units.MM),doc.width>doc.height)?((n=new ActionDescriptor).putUnitDouble(sTID("width"),sTID("distanceUnit"),cm2pt(e)),executeAction(sTID("imageSize"),n,DialogModes.NO)):((n=new ActionDescriptor).putUnitDouble(sTID("height"),sTID("distanceUnit"),cm2pt(e)),executeAction(sTID("imageSize"),n,DialogModes.NO));doc.resolution>t&&t&&doc.resizeImage(void 0,void 0,t,ResampleMethod.PRESERVEDETAILS,0),prefReset()}function indexcolor2rgb(){doc.mode==DocumentMode.INDEXEDCOLOR&&doc.changeMode(ChangeMode.RGB)}// Apfel i
function invert(){executeAction(s2t("invert"),void 0,DialogModes.NO)}function isSelectionActive(){var e=doc.selection;try{return!!e.bounds}catch(e){return!1}}function logger(e){debug&&time_start();var t="~/Desktop/SimonScript.log",n=File(t);n.exists||(n=new File(t));var r=new Date,o=("0"+r.getDate()).slice(-2)+"."+("0"+(r.getMonth()+1)).slice(-2)+"."+r.getFullYear()+" - "+(("0"+r.getHours()).slice(-2)+":"+("0"+r.getMinutes()).slice(-2)+":"+("0"+r.getSeconds()).slice(-2)),i=File(t);i.open("a",void 0,void 0),""!==i&&(i.writeln("-----------------------"),i.writeln(o),i.writeln("Doc: '"+doc.name+"'"),i.writeln("Function: '"+e+"'"),i.writeln(""),i.close()),debug&&time_stop(start)}function mergeLayers(){var e=new ActionDescriptor;executeAction(sTID("mergeLayersNew"),e,DialogModes.NO)}function mm2pt(e){return.283464566929*e}function moveLayer(e,t,n){gotoLayer(e);var r=app.activeDocument.activeLayer;gotoLayer(t);var o=app.activeDocument.activeLayer;if("up"==n)var i=ElementPlacement.PLACEBEFORE;if("down"==n)i=ElementPlacement.PLACEAFTER;if("inside"==n)i=ElementPlacement.INSIDE;if("PlaceAtBeginning"==n)i=ElementPlacement.PLACEATBEGINNING;if("PlaceAtEnd"==n)i=ElementPlacement.PLACEATEND;r.move(o,i)}function moveLayer3(e,t){"up"==e&&(e="next"),"down"==e&&(e="previous"),"top"==e&&(e="front"),"bottom"==e&&(e="back");for(var n=0;n<t;n++){var r=new ActionDescriptor,o=new ActionReference,i=new ActionReference;o.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("targetEnum")),r.putReference(sTID("null"),o),i.putEnumerated(sTID("layer"),sTID("ordinal"),sTID(e)),r.putReference(sTID("to"),i),executeAction(sTID("move"),r,DialogModes.NO)}}function nameLayer(e){try{app.activeDocument.activeLayer.name=e}catch(e){logger(arguments.callee.name)}}function noProfile(){if(doc.colorProfileType==ColorProfile.NONE)try{app.bringToFront();var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("document"),sTID("ordinal"),sTID("targetEnum")),e.putReference(sTID("null"),t),e.putBoolean(sTID("manage"),!0),executeAction(sTID("assignProfile"),e,DialogModes.ALL)}catch(e){}}// Apfel v
function paste_into(){var e=new ActionDescriptor;e.putEnumerated(c2t("AntA"),s2t("antiAliasType"),s2t("antiAliasNone")),executeAction(s2t("pasteInto"),e,DialogModes.NO)}function prefReset(){app.preferences.rulerUnits=startRulerUnits,startDisplayDialogs==DialogModes.ERROR&&(startDisplayDialogs=DialogModes.NO),app.displayDialogs=startDisplayDialogs}function prefSave(){startDisplayDialogs=app.displayDialogs,startRulerUnits=app.preferences.rulerUnits}function prefSet(e,t){e||(alert("check prefSet"),e=DialogModes.NO),t||(alert("check prefSet"),t=Units.MM),app.displayDialogs=e,app.preferences.rulerUnits=t}function rasterSmartObject(){try{var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("targetEnum")),e.putReference(sTID("null"),t),executeAction(sTID("rasterizeLayer"),e,DialogModes.NO)}catch(e){logger(arguments.callee.name)}}function replace__RGB_RZ(e){var t=GetFileNameOnly(doc.name).replace(/(__RGB.*)$/g,e).replace(/(__RZ.*)$/g,e),n=new RegExp(e,"g");if(!t.match(n))t=t+e;return t}function resetImage(){executeAction(sTID("revert"),void 0,DialogModes.NO),emptyProtocoll()}function sRGB2eciRGB(){var e=doc.colorProfileName,t=new RegExp("^sRGB|Apple RGB|ColorMatch RGB");e.match(t)&&doc.convertProfile("eciRGB v2",Intent.RELATIVECOLORIMETRIC,!0,!1)}function saveRZ(e,t,n,r){var o=new Folder(e);o.exists||o.create();for(var i=o+"/"+t+(c=replace__RGB_RZ(r))+"."+n,s=File(i);s.exists;){var c;i=o+"/"+t+(c=c+"+")+"."+n,s=File(i)}if("tif"==n)(a=new TiffSaveOptions).alphaChannels=!0,a.byteOrder=ByteOrder.IBM,a.embedColorProfile=!0,a.imageCompression=TIFFEncoding.TIFFLZW,a.layers=!0,a.spotColors=!1,a.transparency=!0,a.annotations=!1;else if("jpg"==n){(a=new JPEGSaveOptions).embedColorProfile=!0,a.formatOptions=FormatOptions.STANDARDBASELINE,a.matte=MatteType.WHITE,a.quality=11}else if("psd"==n){var a;(a=new PhotoshopSaveOptions).alphaChannels=!1,a.annotations=!1,a.embedColorProfile=!0,a.layers=!0,a.spotColors=!1}doc.saveAs(new File(i),a,!1,Extension.LOWERCASE)}function selectAll(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("targetEnum")),e.putReference(sTID("null"),t),executeAction(sTID("selectAllLayers"),e,DialogModes.NO)}function selectAllLayers(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("targetEnum")),e.putReference(sTID("null"),t),executeAction(sTID("selectAllLayers"),e,DialogModes.NO)}function selectLayer(e,t){var n=new ActionDescriptor,r=new ActionReference;"down"!=e?r.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("forwardEnum")):r.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("backwardEnum")),n.putReference(sTID("null"),r),n.putBoolean(sTID("makeVisible"),!1);var o=0;for(o=1;o<=t;o+=1)executeAction(sTID("select"),n,DialogModes.NO)}function selectLayerUp(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("forwardEnum")),e.putReference(sTID("null"),t),e.putBoolean(sTID("makeVisible"),!1);var n=new ActionList;n.putInteger(108),e.putList(sTID("layerID"),n),executeAction(sTID("select"),e,DialogModes.NO)}function selectLayers(e){var t=new ActionDescriptor,n=new ActionReference;n.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("targetEnum")),t.putReference(sTID("null"),n);try{executeAction(sTID(e),t,DialogModes.NO)}catch(e){}}function setBitDepth(e){var t=charIDToTypeID("CnvM"),n=new ActionDescriptor,r=charIDToTypeID("Dpth");n.putInteger(r,e),executeAction(t,n,DialogModes.NO)}function setDpi(e){var t=new ActionDescriptor;t.putUnitDouble(sTID("resolution"),sTID("densityUnit"),e),executeAction(sTID("imageSize"),t,DialogModes.NO)}function setMegaPixel(e){prefSave(),prefSet(DialogModes.NO,Units.PIXELS);var t=doc.width,n=doc.height,r=t*n,o=1e6*e,i=o/r;if(o<r)if(t>=n){var s=t*Math.sqrt(i);doc.resizeImage(s,void 0,void 0,ResampleMethod.PRESERVEDETAILS,0)}else{var c=Math.round(n*Math.sqrt(i));doc.resizeImage(void 0,c,void 0,ResampleMethod.PRESERVEDETAILS,0)}return prefReset(),""}function setSize(e,t){var n=new ActionDescriptor;n.putUnitDouble(sTID(e),sTID("distanceUnit"),mm2pt(t)),executeAction(sTID("imageSize"),n,DialogModes.NO)}function smartObject(){try{executeAction(stringIDToTypeID("newPlacedLayer"),void 0,DialogModes.NO)}catch(e){logger(arguments.callee.name)}}function smartObjectTransparencyIssue(){var e=doc.activeLayer.name;if(gotoLayer("Original"),tempRulerUnits=app.preferences.rulerUnits,app.preferences.rulerUnits=Units.PIXELS,"LayerKind.SMARTOBJECT"==doc.activeLayer.kind){if(doc.width<doc.height)var t=100*(doc.width+2)/doc.width;else t=100*(doc.height+2)/doc.height;alert(t),transformLayer("center",t)}if(gotoLayer("vorher Ebene"),doc.width<doc.height)t=100*(doc.width+2)/doc.width;else t=100*(doc.height+2)/doc.height;transformLayer("center",t),app.preferences.rulerunits=tempRulerUnits,gotoLayer(e);e=""}function startScriptFile(e,t){var n=new ActionDescriptor;n.putString(sTID("javaScriptName"),e),executeAction(sTID("AdobeScriptAutomation Scripts"),n,t)}function time_start(){start=(new Date).getTime()}function time_stop(e){var t=(new Date).getTime(),n="Done ("+Number((t-e)/1e3).toFixed(3)+" secs).";alert(n)}function transformLayer(e,t){var n=new ActionDescriptor;if("center"==e||"c"==e)var r="QCSAverage";if("topleft"==e||"tl"==e||"↖"==e)r="QCSCorner0";if("top"==e||"t"==e||"↑"==e)r="QCSSide0";if("topright"==e||"tr"==e||"↗"==e)r="QCSCorner1";if("right"==e||"r"==e||"→"==e)r="QCSSide1";if("bottomright"==e||"br"==e||"↘"==e)r="QCSCorner2";if("bottom"==e||"b"==e||"↓"==e)r="QCSSide2";if("bottomleft"==e||"bl"==e||"↙"==e)r="QCSCorner3";if("left"==e||"l"==e||"←"==e)r="QCSSide3";n.putEnumerated(sTID("freeTransformCenterState"),sTID("quadCenterState"),sTID(r));var o=new ActionDescriptor;o.putUnitDouble(sTID("horizontal"),sTID("pixelsUnit"),0),o.putUnitDouble(sTID("vertical"),sTID("pixelsUnit"),0),n.putObject(sTID("offset"),sTID("offset"),o),n.putUnitDouble(sTID("width"),sTID("percentUnit"),t),n.putUnitDouble(sTID("height"),sTID("percentUnit"),t),executeAction(sTID("transform"),n,DialogModes.NO)}function undoSteps(e){for(var t=0;t<e;t++)executeAction(charIDToTypeID("undo"),void 0,DialogModes.NO)}function workingProfile_get(e){
// _modus = RGB || CMYK || Gray || Spot
var t=new ActionReference;return t.putProperty(s2t("property"),s2t("colorSettings")),t.putEnumerated(s2t("application"),s2t("ordinal"),s2t("targetEnum")),executeActionGet(t).getObjectValue(s2t("colorSettings")).getString(s2t("working"+e))}function workingProfile_set(e,t){var n=new ActionDescriptor,r=new ActionDescriptor,o=new ActionReference;o.putProperty(s2t("property"),s2t("colorSettings")),o.putEnumerated(s2t("application"),s2t("ordinal"),s2t("targetEnum")),n.putReference(s2t("null"),o),r.putString(s2t("working"+e),t),n.putObject(s2t("to"),s2t("colorSettings"),r);try{executeAction(s2t("set"),n,DialogModes.NO)}catch(e){alert("kann Arbeitsfarbraum nicht ändern")}}app.documents.length>0&&(doc=app.activeDocument,docs=app.documents),f=!1,t=!0,debug=!1;