function GetFileNameOnly(e){var t=e.lastIndexOf(".");return-1==t?e:e.substr(0,t)}function SmartObject_edit(){var e=new ActionDescriptor;executeAction(sTID("placedLayerEditContents"),e,DialogModes.NO)}function SmartOject_placeItem(e){var t=new ActionDescriptor;t.putPath(cTID("null"),new File(e)),executeAction(sTID("placedLayerReplaceContents"),t,DialogModes.NO)}// CleanSL
function c2t(e){return app.charIDToTypeID(e)}// xtools
function cTID(e){return app.charIDToTypeID(e)}// CleanSL
function s2t(e){return app.stringIDToTypeID(e)}// xtools
function sTID(e){return app.stringIDToTypeID(e)}// CleanSL
function t2s(e){return app.typeIDToStringID(e)}function adjustHue(e,t){return(e+t+360)%360}function adjustLayer_curves_set(e,t,n,r){var o=new ActionDescriptor,s=new ActionDescriptor,i=new ActionDescriptor,c=new ActionDescriptor,a=new ActionDescriptor,u=new ActionList,l=new ActionList,p=new ActionReference,D=new ActionReference;p.putEnumerated(s2t("adjustmentLayer"),s2t("ordinal"),s2t("targetEnum")),o.putReference(s2t("null"),p),s.putEnumerated(s2t("presetKind"),s2t("presetKindType"),s2t("presetKindCustom")),D.putEnumerated(s2t("channel"),s2t("channel"),s2t("composite")),i.putReference(s2t("channel"),D),c.putDouble(s2t("horizontal"),e),c.putDouble(s2t("vertical"),t),l.putObject(s2t("paint"),c),a.putDouble(s2t("horizontal"),n),a.putDouble(s2t("vertical"),r),l.putObject(s2t("paint"),a),i.putList(s2t("curve"),l),u.putObject(s2t("curvesAdjustment"),i),s.putList(s2t("adjustment"),u),o.putObject(s2t("to"),s2t("curves"),s),executeAction(s2t("set"),o,DialogModes.NO)}function adjustLayer_levels_autoLevels(e,t){
/* reset levels */
adjustLayer_levels_edit(null);
/* set autoLevels option */
var n=new ActionDescriptor,r=new ActionDescriptor,o=new ActionDescriptor,s=new ActionList,i=new ActionReference,c=new ActionReference;i.putEnumerated(s2t("adjustmentLayer"),s2t("ordinal"),s2t("targetEnum")),n.putReference(s2t("null"),i),c.putEnumerated(s2t("channel"),s2t("channel"),s2t("composite")),o.putReference(s2t("channel"),c),"autoContrast"==e&&o.putBoolean(s2t("autoContrast"),!0),"auto"==e&&o.putBoolean(s2t("auto"),!0),"autoBlackWhite"==e&&o.putBoolean(s2t("autoBlackWhite"),!0),"autoMachineLearning"==e&&(o.putBoolean(s2t("autoMachineLearning"),!0),o.putBoolean(s2t("autoFaces"),!0)),t&&o.putBoolean(s2t("autoNeutrals"),t),s.putObject(s2t("levelsAdjustment"),o),r.putList(s2t("adjustment"),s),n.putObject(s2t("to"),s2t("levels"),r),executeAction(s2t("set"),n,DialogModes.NO)}function adjustLayer_levels_autoLevels_wrapper(e,t){var n=layer_selectedIDX_get();"LayerKind.LEVELS"==doc.activeLayer.kind?
// alert("ding")
makeVisible():layer_checkExistence("AutoTonwert")?(gotoLayer("AutoTonwert"),makeVisible()):alert("keine TonWert-Ebene ausgewählt bzw vorbereitet"),adjustLayer_levels_autoLevels(e,t),layer_selectedIDX_set(n)}function adjustLayer_levels_edit(e,t,n,r,o,s,t,i,c,a,u,l,p,D,d,I,T,f,g,m){var A=new ActionDescriptor,y=new ActionDescriptor,v=new ActionDescriptor,h=new ActionDescriptor,w=new ActionDescriptor,R=new ActionDescriptor,E=new ActionList,b=new ActionList,L=new ActionList,M=new ActionList,O=new ActionList,S=new ActionList,x=new ActionList,C=new ActionList,N=new ActionList,j=new ActionReference,P=new ActionReference,_=new ActionReference,k=new ActionReference,B=new ActionReference;null==e&&(e=0),null==t&&(t=255),null==n&&(n=0),null==r&&(r=255),null==o&&(o=1),null==s&&(s=0),null==t&&(t=255),null==i&&(i=0),null==c&&(c=255),null==a&&(a=1),null==u&&(u=0),null==l&&(l=255),null==p&&(p=0),null==D&&(D=255),null==d&&(d=1),null==I&&(I=0),null==T&&(T=255),null==f&&(f=0),null==g&&(g=255),null==m&&(m=1),j.putEnumerated(s2t("adjustmentLayer"),s2t("ordinal"),s2t("targetEnum")),A.putReference(s2t("null"),j),y.putEnumerated(s2t("presetKind"),s2t("presetKindType"),s2t("presetKindDefault")),P.putEnumerated(s2t("channel"),s2t("channel"),s2t("composite")),v.putReference(s2t("channel"),P),b.putInteger(e),b.putInteger(t),v.putList(s2t("input"),b),v.putDouble(s2t("gamma"),o),L.putInteger(n),L.putInteger(r),v.putList(s2t("output"),L),E.putObject(s2t("levelsAdjustment"),v),_.putEnumerated(s2t("channel"),s2t("channel"),s2t("red")),h.putReference(s2t("channel"),_),M.putInteger(s),M.putInteger(t),h.putList(s2t("input"),M),h.putDouble(s2t("gamma"),a),O.putInteger(i),O.putInteger(c),h.putList(s2t("output"),O),E.putObject(s2t("levelsAdjustment"),h),k.putEnumerated(s2t("channel"),s2t("channel"),s2t("grain")),w.putReference(s2t("channel"),k),S.putInteger(u),S.putInteger(l),w.putList(s2t("input"),S),w.putDouble(s2t("gamma"),d),x.putInteger(p),x.putInteger(D),w.putList(s2t("output"),x),E.putObject(s2t("levelsAdjustment"),w),B.putEnumerated(s2t("channel"),s2t("channel"),s2t("blue")),R.putReference(s2t("channel"),B),C.putInteger(I),C.putInteger(T),R.putList(s2t("input"),C),R.putDouble(s2t("gamma"),m),N.putInteger(f),N.putInteger(g),R.putList(s2t("output"),N),E.putObject(s2t("levelsAdjustment"),R),y.putList(s2t("adjustment"),E),A.putObject(s2t("to"),s2t("levels"),y),executeAction(s2t("set"),A,DialogModes.NO)}function adjustLayer_sat_eyedropper(){var e=new ActionDescriptor,t=new ActionReference;t.putClass(s2t("eyedropper2Tool")),e.putReference(s2t("null"),t);try{executeAction(s2t("select"),e,DialogModes.NO);
// return;
}catch(e){alert("Error: "+e)}}function adjustLayer_sat_set(e,t,n,r,o,s,i,c){var a=new ActionDescriptor,u=new ActionDescriptor,l=new ActionDescriptor,p=new ActionList,D=new ActionReference;s=s||0,i=i||0,c=c||0;D.putEnumerated(s2t("adjustmentLayer"),s2t("ordinal"),s2t("targetEnum")),a.putReference(s2t("null"),D),u.putEnumerated(s2t("presetKind"),s2t("presetKindType"),s2t("presetKindCustom")),l.putInteger(s2t("localRange"),e),// red=1 || yellow=2 …
l.putInteger(s2t("beginRamp"),t),l.putInteger(s2t("beginSustain"),n),l.putInteger(s2t("endSustain"),r),l.putInteger(s2t("endRamp"),o),l.putInteger(s2t("hue"),s),l.putInteger(s2t("saturation"),i),l.putInteger(s2t("lightness"),c),p.putObject(s2t("hueSatAdjustmentV2"),l),u.putList(s2t("adjustment"),p),a.putObject(s2t("to"),s2t("hueSaturation"),u),executeAction(s2t("set"),a,DialogModes.NO)}function app_getColor(e,t){var n=[];if("vordergrund"==t||"foreground"==t)var r=app.foregroundColor;else r=app.backgroundColor;if("rgb"==e){var o=r.rgb;n.push(Math.round(o.red)),n.push(Math.round(o.green)),n.push(Math.round(o.blue))}else if("hsb"==e||"hsl"==e){o=r.hsb;n.push(Math.round(o.hue)),n.push(Math.round(o.saturation)),n.push(Math.round(o.brightness))}return n}function app_getForegroundColor(){var e=[],t=app.foregroundColor;return e.push(Math.round(t.rgb.red)),e.push(Math.round(t.rgb.green)),e.push(Math.round(t.rgb.blue)),e}function app_simulateKeyPress_alt3(){try{app.bringToFront();app.system("osascript -e 'tell application 'System Events' to keystroke '3' using {option down}'")}catch(e){
// alert(e)
}}function arrayCorrect(e){if("function"!=typeof Array.isArray&&(Array.isArray=function(e){return null!=e&&e.constructor==Array}),!Array.isArray(e)){var t=e.toString();
/* alert("arr2str: " + arr2str); */e=[],e=t.split(",")}return e}function array_contains(e,t){if(e)for(var n=0;n<e.length;n++)if(e[n]===t)return!0;return!1}function assignProfile(e){var t=new ActionDescriptor,n=new ActionReference;n.putEnumerated(sTID("document"),sTID("ordinal"),sTID("targetEnum")),t.putReference(sTID("null"),n),t.putString(sTID("profile"),e),executeAction(sTID("assignProfile"),t,DialogModes.NO)}// function blendif(_blackMin, _blackMax, _whiteMin, _whiteMax) {
//     var d = new ActionDescriptor();
//     var r = new ActionReference();
//     r.putEnumerated(sTID('layer'), sTID('ordinal'), sTID('targetEnum'));
//     d.putReference(sTID('null'), r);
//     var d2 = new ActionDescriptor();
//     var l = new ActionList();
//     var d3 = new ActionDescriptor();
//     var r2 = new ActionReference();
//     r2.putEnumerated(sTID('channel'), sTID('channel'), sTID('gray'));
//     d3.putReference(sTID('channel'), r2);
//     d3.putInteger(sTID('srcBlackMin'), 0);
//     d3.putInteger(sTID('srcBlackMax'), 0);
//     d3.putInteger(sTID('srcWhiteMin'), 255);
//     d3.putInteger(sTID('srcWhiteMax'), 255);
//     d3.putInteger(sTID('destBlackMin'), _blackMin);
//     d3.putInteger(sTID('destBlackMax'), _blackMax);
//     d3.putInteger(sTID('destWhiteMin'), _whiteMin);
//     d3.putInteger(sTID('desaturate'), _whiteMax);
//     l.putObject(sTID('blendRange'), d3);
//     d2.putList(sTID('blendRange'), l);
//     var d4 = new ActionDescriptor();
//     d4.putUnitDouble(sTID('scale'), sTID('percentUnit'), 100.000000);
//     d2.putObject(sTID('layerEffects'), sTID('layerEffects'), d4);
//     d.putObject(sTID('to'), sTID('layer'), d2);
//     executeAction(sTID('set'), d, DialogModes.NO);
// }
function blendif(e,t,n,r,o){var s=new ActionDescriptor,i=new ActionReference;isNaN(e)?i.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("targetEnum")):i.putIndex(s2t("layer"),e),s.putReference(sTID("null"),i);var c=new ActionDescriptor,a=new ActionList,u=new ActionDescriptor,l=new ActionReference;l.putEnumerated(sTID("channel"),sTID("channel"),sTID("gray")),u.putReference(sTID("channel"),l),u.putInteger(sTID("srcBlackMin"),0),u.putInteger(sTID("srcBlackMax"),0),u.putInteger(sTID("srcWhiteMin"),255),u.putInteger(sTID("srcWhiteMax"),255),u.putInteger(sTID("destBlackMin"),t),u.putInteger(sTID("destBlackMax"),n),u.putInteger(sTID("destWhiteMin"),r),u.putInteger(sTID("desaturate"),o),a.putObject(sTID("blendRange"),u),c.putList(sTID("blendRange"),a),s.putObject(sTID("to"),sTID("layer"),c),executeAction(sTID("set"),s,DialogModes.NO)}function checkTransparency(){return doc.suspendHistory("Transparent Check","checkTransparency_inner()"),undoSteps(1),!!transp}function checkTransparency_inner(){prefSave(),transp=!0;var e=function(e){return app.stringIDToTypeID(e)},t=new ActionDescriptor,n=new ActionDescriptor,r=new ActionReference,o=new ActionReference,s=new ActionReference;r.putProperty(e("channel"),e("selection")),t.putReference(e("null"),r),o.putEnumerated(e("channel"),e("channel"),e("transparencyEnum")),o.putEnumerated(e("layer"),e("ordinal"),e("merged")),n.putReference(e("to"),o),s.putEnumerated(e("channel"),e("channel"),e("transparencyEnum")),s.putEnumerated(e("layer"),e("ordinal"),e("merged")),n.putReference(e("source2"),s),t.putObject(e("to"),e("calculation"),n);try{executeAction(e("set"),t,DialogModes.NO),activeDocument.selection.invert();try{activeDocument.selection.bounds}catch(e){transp=!1}}catch(e){transp=!1}return prefReset(),activeDocument.selection.deselect(),transp}function clearAllGuides(){executeAction(sTID("clearAllGuides"),void 0,DialogModes.NO)}function cm2pt(e){return 28.3464566929*e}function cmyk2rgb(){doc.mode==DocumentMode.CMYK&&doc.convertProfile("eciRGB v2 ICCv4",Intent.RELATIVECOLORIMETRIC,!0,!1)}// Apfel c
function copy(){executeAction(cTID("copy"),void 0,DialogModes.NO)}function createColorLayer(e,t,n,r,o,s,i,c){try{var a=new ActionDescriptor,u=new ActionReference;u.putClass(sTID("contentLayer")),a.putReference(sTID("null"),u);var l=new ActionDescriptor;l.putString(sTID("name"),e),l.putUnitDouble(sTID("opacity"),sTID("percentUnit"),r),l.putEnumerated(sTID("mode"),sTID("blendMode"),sTID(t)),l.putEnumerated(sTID("color"),sTID("color"),sTID(n));var p=new ActionDescriptor,D=new ActionDescriptor;if(D.putDouble(sTID("red"),s),D.putDouble(sTID("green"),i),D.putDouble(sTID("blue"),c),p.putObject(sTID("color"),sTID("RGBColor"),D),l.putObject(sTID("type"),sTID("solidColorLayer"),p),a.putObject(sTID("using"),sTID("contentLayer"),l),executeAction(sTID("make"),a,DialogModes.NO),gotoMask(),"invert"==o)return void executeAction(sTID("invert"),void 0,DialogModes.NO);if("none"==o)return void deleteMask();if("black"==o||"white"==o||"gray"==o)return void fill(o,"normal",100)}catch(e){logger(arguments.callee.name)}}function createGroup(e,t,n,r,o){try{var s=new ActionDescriptor,i=new ActionReference;if(i.putClass(sTID("layerSection")),s.putReference(sTID("null"),i),o){var c=new ActionReference;c.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("targetEnum")),s.putReference(sTID("from"),c)}var a=new ActionDescriptor;a.putString(sTID("name"),e),a.putUnitDouble(sTID("opacity"),sTID("percentUnit"),r),a.putEnumerated(sTID("color"),sTID("color"),sTID(n)),a.putEnumerated(sTID("mode"),sTID("blendMode"),sTID(t)),s.putObject(sTID("using"),sTID("layerSection"),a),s.putInteger(sTID("layerSectionStart"),351),s.putInteger(sTID("layerSectionEnd"),352),s.putString(sTID("name"),"Gruppe 3"),executeAction(sTID("make"),s,DialogModes.NO)}catch(e){logger(arguments.callee.name)}}function createLayer(e,t,n,r,o,s,i,c){try{var a=new ActionDescriptor,u=new ActionReference;u.putClass(sTID("adjustmentLayer")),a.putReference(sTID("null"),u);var l=new ActionDescriptor;if(l.putString(sTID("name"),e),l.putUnitDouble(sTID("opacity"),sTID("percentUnit"),o),l.putEnumerated(sTID("mode"),sTID("blendMode"),sTID(n)),l.putEnumerated(sTID("color"),sTID("color"),sTID(r)),l.putBoolean(sTID("group"),i),"levels"==t&&c){var p=new ActionDescriptor;p.putEnumerated(sTID("presetKind"),sTID("presetKindType"),sTID("presetKindDefault"));var D=new ActionList,d=new ActionDescriptor,I=new ActionReference;I.putEnumerated(sTID("channel"),sTID("channel"),sTID("composite")),d.putReference(sTID("channel"),I),d.putBoolean(sTID("auto"),!0),D.putObject(sTID("levelsAdjustment"),d),p.putList(sTID("adjustment"),D),l.putObject(sTID("type"),sTID(t),p)}else l.putClass(sTID("type"),sTID(t));if(a.putObject(sTID("using"),sTID("adjustmentLayer"),l),executeAction(sTID("make"),a,DialogModes.NO),"invert"==s)return void executeAction(sTID("invert"),void 0,DialogModes.NO);if("none"==s)return void deleteMask();if("black"==s||"white"==s||"gray"==s)return void fill(s,"normal",100)}catch(e){logger(arguments.callee.name)}}function createMask(){var e=new ActionDescriptor,t=new ActionReference;e.putClass(s2t("new"),s2t("channel")),t.putEnumerated(s2t("channel"),s2t("channel"),s2t("mask")),e.putReference(s2t("at"),t),e.putEnumerated(s2t("using"),c2t("UsrM"),s2t("revealAll")),executeAction(s2t("make"),e,DialogModes.NO)}function crop_bySelection(){var e=new ActionDescriptor;e.putBoolean(s2t("delete"),!0),executeAction(s2t("crop"),e,DialogModes.NO)}function deleteHistory(){var e=new ActionDescriptor,t=new ActionReference;t.putProperty(charIDToTypeID("HstS"),charIDToTypeID("CrnH")),e.putReference(charIDToTypeID("null"),t),executeAction(charIDToTypeID("Dlt "),e,DialogModes.NO)}function deleteMask(){try{var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("channel"),sTID("channel"),sTID("mask")),e.putReference(sTID("null"),t),executeAction(sTID("delete"),e,DialogModes.NO)}catch(e){logger(arguments.callee.name)}}function dublicate(e){var t=new ActionDescriptor,n=new ActionReference;n.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("targetEnum")),t.putReference(sTID("null"),n),t.putString(sTID("name"),e),t.putInteger(sTID("version"),5),executeAction(sTID("duplicate"),t,DialogModes.NO)}function emptyProtocoll(){var e=new ActionDescriptor;e.putEnumerated(cTID("null"),cTID("PrgI"),cTID("Al  ")),executeAction(cTID("Prge"),e,DialogModes.NO);for(var t=app.activeDocument.historyStates,n=t.length-1;n>=0;--n)t[n].snapshot&&(app.activeDocument.activeHistoryState=t[n],deleteHistory())}function fill(e,t,n,r,o,s){try{var i=new ActionDescriptor;if(i.putEnumerated(sTID("using"),sTID("fillContents"),sTID(e)),"color"==e){var c=new ActionDescriptor;c.putUnitDouble(sTID("hue"),sTID("angleUnit"),r),c.putDouble(sTID("saturation"),o),c.putDouble(sTID("brightness"),s),i.putObject(sTID("color"),sTID("HSBColorClass"),c)}i.putUnitDouble(sTID("opacity"),sTID("percentUnit"),n),i.putEnumerated(sTID("mode"),sTID("blendMode"),sTID(t)),executeAction(sTID("fill"),i,DialogModes.NO)}catch(e){logger(arguments.callee.name)}}function flattenImage(){executeAction(charIDToTypeID("FltI"),void 0,DialogModes.NO)}function getBitDepth(){if("BitsPerChannelType.EIGHT"==doc.bitsPerChannel)var e=8;else if(doc.bitsPerChannel==BitsPerChannelType.SIXTEEN)e=16;else{if(doc.bitsPerChannel!=BitsPerChannelType.THIRTYTWO)return!1;e=32}return e}function getScale(e){var t=1e6*e/(doc.width*doc.height);return Math.sqrt(t)}function gotoFill(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("channel"),sTID("channel"),sTID("RGB")),e.putReference(sTID("null"),t),e.putBoolean(sTID("makeVisible"),!1),executeAction(sTID("select"),e,DialogModes.NO)}function gotoLayer(e){var t=new ActionDescriptor,n=new ActionReference;"number"==typeof e?n.putIndex(charIDToTypeID("Lyr "),e):"string"==typeof e&&n.putName(sTID("layer"),e),t.putReference(sTID("null"),n),t.putBoolean(sTID("makeVisible"),!1),executeAction(sTID("select"),t,DialogModes.NO)}function gotoLayer_byID(e){var t=new ActionDescriptor,n=new ActionReference;n.putIdentifier(s2t("layer"),e),t.putReference(sTID("null"),n),t.putBoolean(sTID("makeVisible"),!1),executeAction(sTID("select"),t,DialogModes.NO)}function gotoLayer_bySelector(e){var t=new ActionDescriptor,n=new ActionReference;try{"number"==typeof e?n.putIndex(s2t("layer"),e):"string"==typeof e&&(layer_checkExistence(e)?n.putName(s2t("layer"),e):n.putIndex(s2t("layer"),layer_getIDXbyString(e)[0])),t.putReference(sTID("null"),n),t.putBoolean(sTID("makeVisible"),!1),executeAction(sTID("select"),t,DialogModes.NO)}catch(e){debug&&alert("ERROR - gotoLayer_bySelector: \n"+e)}}function gotoMask(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("channel"),sTID("channel"),sTID("mask")),e.putReference(sTID("null"),t),e.putBoolean(sTID("makeVisible"),!1),executeAction(sTID("select"),e,DialogModes.NO)}function gray2rgb(){doc.mode==DocumentMode.GRAYSCALE&&doc.convertProfile("eciRGB v2 ICCv4",Intent.RELATIVECOLORIMETRIC,!0,!1)}function hasBackground(){
// var ref = new ActionReference();
// ref.putProperty(charIDToTypeID("Prpr"), charIDToTypeID("Bckg"));
// ref.putEnumerated(charIDToTypeID("Lyr "), charIDToTypeID("Ordn"), charIDToTypeID("Back"));
// var desc = executeActionGet(ref);
// var res = desc.getBoolean(charIDToTypeID("Bckg"));
// return res;
var e=void 0;try{var t=new ActionReference;t.putProperty(cTID("Prpr"),cTID("Nm  ")),t.putIndex(cTID("Lyr "),0),executeActionGet(t).getString(cTID("Nm  ")),e=!0}catch(t){e=!1}return e}function historyState_deleteSteps(e){try{for(var t=0;t<e;t++){var n=new ActionDescriptor,r=new ActionReference;r.putEnumerated(s2t("historyState"),s2t("ordinal"),s2t("last")),n.putReference(s2t("null"),r),executeAction(s2t("delete"),n,DialogModes.NO)}}catch(e){}}function img_resize(e,t){var n;(prefSave(),prefSet(DialogModes.NO,Units.MM),doc.width>doc.height)?((n=new ActionDescriptor).putUnitDouble(sTID("width"),sTID("distanceUnit"),cm2pt(e)),executeAction(sTID("imageSize"),n,DialogModes.NO)):((n=new ActionDescriptor).putUnitDouble(sTID("height"),sTID("distanceUnit"),cm2pt(e)),executeAction(sTID("imageSize"),n,DialogModes.NO));doc.resolution>t&&t&&doc.resizeImage(void 0,void 0,t,ResampleMethod.PRESERVEDETAILS,0),prefReset()}function indexcolor2rgb(){doc.mode==DocumentMode.INDEXEDCOLOR&&doc.changeMode(ChangeMode.RGB)}function interpolation_GigaPixel(e,t,n){
// var scale = (_minAufloesung / _horizontalPPI).toFixed(2).replace('.', ',');
// text2Clipboard(scale);
var r=app.preferences.rulerUnits;app.preferences.rulerUnits=Units.PIXELS;var o=parseInt(app.activeDocument.width);text2Clipboard(Math.ceil(t*o)),app.preferences.rulerUnits=r,
// executeAction(sTID('913d412a-534a-5224-a25d-213434343434'), undefined, DialogModes.ALL);
executeAction(sTID("1E822513-BC4D-4CF2-B1FE-80505B509928"),void 0,DialogModes.ALL),setDpi(n)}function interpolation_PS(e,t,n){try{if(e<t)
/* alert("hoch rechnen: hPPI: " + _horizontalPPI + "; minAuflösung: " + _minAufloesung); */
return void app.activeDocument.resizeImage(void 0,void 0,t,ResampleMethod.PRESERVEDETAILS);e>n?
/* alert("runter rechnen: hPPI: " + _horizontalPPI + "; ZielAufloesung: " + _ZielAufloesung); */
app.activeDocument.resizeImage(void 0,void 0,n,ResampleMethod.PRESERVEDETAILS):
/* alert("wedernoch rechnen: hPPI: " + _horizontalPPI + "; ZielAufloesung: " + _ZielAufloesung + "; minAuflösung: " + _minAufloesung); */
/* myPsDoc.resizeImage(undefined, undefined, _horizontalPPI, ResampleMethod.NONE); */
setDpi(e)}catch(e){alert(e)}}function interpolation_PhotoAI(e,t,n){text2Clipboard((t/e).toFixed(2).replace(".",",")),
/*  var width = pt2mm(_width) * 10; */
/* text2Clipboard(_width); */
executeAction(sTID("a40009fc-f5fc-4a09-86ec-5a0ed56c5668"),void 0,DialogModes.ALL),setDpi(t)}/* Apfel i */
function invert(){executeAction(s2t("invert"),void 0,DialogModes.NO)}function isSelectionActive(){var e=doc.selection;try{return!!e.bounds}catch(e){return!1}}function loadJSON(e){var t,n=new File(e);if(!n.exists)return alert("Die JSON-Datei konnte nicht gefunden werden."),null;n.open("r"),t=n.read(),n.close();
// Parse JSON-Inhalt
try{return JSON.parse(t)}catch(e){return alert("Fehler beim Parsen der JSON-Datei:\n"+e),null}}
// Funktion zum Finden eines Wertes in einem Array von Objekten
function jsonValue(e){for(var t=0;t<jsonData.length;t++)if(void 0!==jsonData[t][e])return jsonData[t][e];return null}function logger(e){debug&&time_start();var t="~/Desktop/SimonScript.log",n=File(t);n.exists||(n=new File(t));var r=new Date,o=("0"+r.getDate()).slice(-2)+"."+("0"+(r.getMonth()+1)).slice(-2)+"."+r.getFullYear()+" - "+(("0"+r.getHours()).slice(-2)+":"+("0"+r.getMinutes()).slice(-2)+":"+("0"+r.getSeconds()).slice(-2)),s=File(t);s.open("a",void 0,void 0),""!==s&&(s.writeln("-----------------------"),s.writeln(o),s.writeln("Doc: '"+doc.name+"'"),s.writeln("Function: '"+e+"'"),s.writeln(""),s.close()),debug&&time_stop(start)}function mergeLayers(){var e=new ActionDescriptor;executeAction(sTID("mergeLayersNew"),e,DialogModes.NO)}function mm2pt(e){return 2.83464566929*e}function moveLayer(e,t,n){gotoLayer(e);var r=app.activeDocument.activeLayer;gotoLayer(t);var o=app.activeDocument.activeLayer;if("up"==n)var s=ElementPlacement.PLACEBEFORE;if("down"==n)s=ElementPlacement.PLACEAFTER;if("inside"==n)s=ElementPlacement.INSIDE;if("PlaceAtBeginning"==n)s=ElementPlacement.PLACEATBEGINNING;if("PlaceAtEnd"==n)s=ElementPlacement.PLACEATEND;r.move(o,s)}function moveLayer3(e,t){"up"==e&&(e="next"),"down"==e&&(e="previous"),"top"==e&&(e="front"),"bottom"==e&&(e="back");for(var n=0;n<t;n++){var r=new ActionDescriptor,o=new ActionReference,s=new ActionReference;o.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("targetEnum")),r.putReference(sTID("null"),o),s.putEnumerated(sTID("layer"),sTID("ordinal"),sTID(e)),r.putReference(sTID("to"),s),executeAction(sTID("move"),r,DialogModes.NO)}}function nameLayer(e){try{app.activeDocument.activeLayer.name=e}catch(e){logger(arguments.callee.name)}}function noProfile(){if(doc.colorProfileType==ColorProfile.NONE)try{app.bringToFront();var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("document"),sTID("ordinal"),sTID("targetEnum")),e.putReference(sTID("null"),t),e.putBoolean(sTID("manage"),!0),executeAction(sTID("assignProfile"),e,DialogModes.ALL)}catch(e){}}// Apfel v
function paste_into(){var e=new ActionDescriptor;e.putEnumerated(c2t("AntA"),s2t("antiAliasType"),s2t("antiAliasNone")),executeAction(s2t("pasteInto"),e,DialogModes.NO)}function prefReset(){app.preferences.rulerUnits=startRulerUnits,startDisplayDialogs==DialogModes.ERROR&&(startDisplayDialogs=DialogModes.NO),app.displayDialogs=startDisplayDialogs}function prefSave(){startDisplayDialogs=app.displayDialogs,startRulerUnits=app.preferences.rulerUnits}function prefSet(e,t){e||(alert("check prefSet"),e=DialogModes.NO),t||(alert("check prefSet"),t=Units.MM),app.displayDialogs=e,app.preferences.rulerUnits=t}function pt2cm(e){return e/2.83464566929}function rasterSmartObject(){try{var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("targetEnum")),e.putReference(sTID("null"),t),executeAction(sTID("rasterizeLayer"),e,DialogModes.NO)}catch(e){logger(arguments.callee.name)}}function replace__RGB_RZ(e){var t=GetFileNameOnly(doc.name).replace(/(__RGB.*)$/g,e).replace(/(__RZ.*)$/g,e).replace(/(__WEB.*)$/g,e),n=new RegExp(e,"g");if(!t.match(n))t=t+e;return t}function resetImage(){executeAction(sTID("revert"),void 0,DialogModes.NO),emptyProtocoll()}function sRGB2eciRGB(){var e=doc.colorProfileName,t=new RegExp("^sRGB|Apple RGB|ColorMatch RGB");e.match(t)&&doc.convertProfile("eciRGB v2 ICCv4",Intent.RELATIVECOLORIMETRIC,!0,!1)}function saveRZ(e,t,n,r){var o=new Folder(e);o.exists||o.create();for(var s=o+"/"+t+(c=replace__RGB_RZ(r))+"."+n,i=File(s);i.exists;){var c;s=o+"/"+t+(c=c+"+")+"."+n,i=File(s)}if("tif"==n)(a=new TiffSaveOptions).alphaChannels=!0,a.byteOrder=ByteOrder.IBM,a.embedColorProfile=!0,a.imageCompression=TIFFEncoding.TIFFLZW,a.layers=!0,a.spotColors=!1,a.transparency=!0,a.annotations=!1;else if("jpg"==n){(a=new JPEGSaveOptions).embedColorProfile=!0,a.formatOptions=FormatOptions.STANDARDBASELINE,a.matte=MatteType.WHITE,a.quality=11}else if("psd"==n){var a;(a=new PhotoshopSaveOptions).alphaChannels=!1,a.annotations=!1,a.embedColorProfile=!0,a.layers=!0,a.spotColors=!1}doc.saveAs(new File(s),a,!1,Extension.LOWERCASE)}function selectAll(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("targetEnum")),e.putReference(sTID("null"),t),executeAction(sTID("selectAllLayers"),e,DialogModes.NO)}function selectAllLayers(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("targetEnum")),e.putReference(sTID("null"),t),executeAction(sTID("selectAllLayers"),e,DialogModes.NO)}function selectLayer(e,t){var n=new ActionDescriptor,r=new ActionReference;"down"!=e?r.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("forwardEnum")):r.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("backwardEnum")),n.putReference(sTID("null"),r),n.putBoolean(sTID("makeVisible"),!1);var o=0;for(o=1;o<=t;o+=1)executeAction(sTID("select"),n,DialogModes.NO)}function selectLayerUp(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("forwardEnum")),e.putReference(sTID("null"),t),e.putBoolean(sTID("makeVisible"),!1);var n=new ActionList;n.putInteger(108),e.putList(sTID("layerID"),n),executeAction(sTID("select"),e,DialogModes.NO)}function selectLayers(e){var t=new ActionDescriptor,n=new ActionReference;n.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("targetEnum")),t.putReference(sTID("null"),n);try{executeAction(sTID(e),t,DialogModes.NO)}catch(e){}}function setBitDepth(e){var t=charIDToTypeID("CnvM"),n=new ActionDescriptor,r=charIDToTypeID("Dpth");n.putInteger(r,e),executeAction(t,n,DialogModes.NO)}function setDpi(e){var t=new ActionDescriptor;t.putUnitDouble(sTID("resolution"),sTID("densityUnit"),e),executeAction(sTID("imageSize"),t,DialogModes.NO)}function setMegaPixel(e){prefSave(),prefSet(DialogModes.NO,Units.PIXELS);var t=doc.width,n=doc.height,r=t*n,o=1e6*e,s=o/r;if(o<r)if(t>=n){var i=t*Math.sqrt(s);doc.resizeImage(i,void 0,void 0,ResampleMethod.PRESERVEDETAILS,0)}else{var c=Math.round(n*Math.sqrt(s));doc.resizeImage(void 0,c,void 0,ResampleMethod.PRESERVEDETAILS,0)}return prefReset(),""}function setSize(e,t,n){var r=new ActionDescriptor;"mm"==n&&(t=mm2pt(t)),r.putUnitDouble(sTID(e),sTID("distanceUnit"),t),executeAction(sTID("imageSize"),r,DialogModes.NO)}function smartObject(){try{executeAction(stringIDToTypeID("newPlacedLayer"),void 0,DialogModes.NO)}catch(e){logger(arguments.callee.name)}}function smartObjectTransparencyIssue(){var e=doc.activeLayer.name;if(gotoLayer("Original"),tempRulerUnits=app.preferences.rulerUnits,app.preferences.rulerUnits=Units.PIXELS,"LayerKind.SMARTOBJECT"==doc.activeLayer.kind){if(doc.width<doc.height)var t=100*(doc.width+2)/doc.width;else t=100*(doc.height+2)/doc.height;alert(t),transformLayer("center",t)}if(gotoLayer("vorher Ebene"),doc.width<doc.height)t=100*(doc.width+2)/doc.width;else t=100*(doc.height+2)/doc.height;transformLayer("center",t),app.preferences.rulerunits=tempRulerUnits,gotoLayer(e);e=""}function startScriptFile(e,t){var n=new ActionDescriptor;n.putString(sTID("javaScriptName"),e),executeAction(sTID("AdobeScriptAutomation Scripts"),n,t)}function text2Clipboard(e){var t=new ActionDescriptor;t.putString(stringIDToTypeID("textData"),e),executeAction(stringIDToTypeID("textToClipboard"),t,DialogModes.NO)}function time_start(){start=(new Date).getTime()}function time_stop(e){var t=(new Date).getTime(),n="Done ("+Number((t-e)/1e3).toFixed(3)+" secs).";alert(n)}function transformLayer(e,t){var n=new ActionDescriptor;if("center"==e||"c"==e)var r="QCSAverage";if("topleft"==e||"tl"==e||"↖"==e)r="QCSCorner0";if("top"==e||"t"==e||"↑"==e)r="QCSSide0";if("topright"==e||"tr"==e||"↗"==e)r="QCSCorner1";if("right"==e||"r"==e||"→"==e)r="QCSSide1";if("bottomright"==e||"br"==e||"↘"==e)r="QCSCorner2";if("bottom"==e||"b"==e||"↓"==e)r="QCSSide2";if("bottomleft"==e||"bl"==e||"↙"==e)r="QCSCorner3";if("left"==e||"l"==e||"←"==e)r="QCSSide3";n.putEnumerated(sTID("freeTransformCenterState"),sTID("quadCenterState"),sTID(r));var o=new ActionDescriptor;o.putUnitDouble(sTID("horizontal"),sTID("pixelsUnit"),0),o.putUnitDouble(sTID("vertical"),sTID("pixelsUnit"),0),n.putObject(sTID("offset"),sTID("offset"),o),n.putUnitDouble(sTID("width"),sTID("percentUnit"),t),n.putUnitDouble(sTID("height"),sTID("percentUnit"),t),executeAction(sTID("transform"),n,DialogModes.NO)}function undoSteps(e){try{for(var t=0;t<e;t++)try{executeAction(charIDToTypeID("undo"),void 0,DialogModes.NO)}catch(e){
// by Michael L. Hale
// For the menu item 'Step Backward' ( the same as alt-ctrl-z ) use this
var n=new ActionDescriptor,r=new ActionReference;r.putEnumerated(charIDToTypeID("HstS"),charIDToTypeID("Ordn"),charIDToTypeID("Prvs")),n.putReference(charIDToTypeID("null"),r),executeAction(charIDToTypeID("slct"),n,DialogModes.NO)}}catch(e){}}function workingProfile_get(e){
// _modus = RGB || CMYK || Gray || Spot
var t=new ActionReference;t.putProperty(s2t("property"),s2t("colorSettings")),t.putEnumerated(s2t("application"),s2t("ordinal"),s2t("targetEnum"));try{return executeActionGet(t).getObjectValue(s2t("colorSettings")).getString(s2t("working"+e))}catch(e){alert(e)}}function workingProfile_set(e,t){var n=new ActionDescriptor,r=new ActionDescriptor,o=new ActionReference;o.putProperty(s2t("property"),s2t("colorSettings")),o.putEnumerated(s2t("application"),s2t("ordinal"),s2t("targetEnum")),n.putReference(s2t("null"),o),r.putString(s2t("working"+e),t),n.putObject(s2t("to"),s2t("colorSettings"),r);try{executeAction(s2t("set"),n,DialogModes.NO)}catch(e){alert("kann Arbeitsfarbraum nicht ändern")}}app.documents.length>0&&(doc=app.activeDocument,docs=app.documents),f=!1,t=!0,debug=!1;