function GetFileNameOnly(e){var t=e.lastIndexOf(".");return-1==t?e:e.substr(0,t)}function SmartObject_edit(){var e=new ActionDescriptor;executeAction(sTID("placedLayerEditContents"),e,DialogModes.NO)}function SmartOject_placeItem(e){var t=new ActionDescriptor;t.putPath(cTID("null"),new File(e)),executeAction(sTID("placedLayerReplaceContents"),t,DialogModes.NO)}// CleanSL
function c2t(e){return app.charIDToTypeID(e)}// xtools
function cTID(e){return app.charIDToTypeID(e)}// CleanSL
function s2t(e){return app.stringIDToTypeID(e)}// xtools
function sTID(e){return app.stringIDToTypeID(e)}// CleanSL
function t2s(e){return app.typeIDToStringID(e)}function app_getForegroundColor(){var e=[],t=app.foregroundColor;return e.push(Math.round(t.rgb.red)),e.push(Math.round(t.rgb.green)),e.push(Math.round(t.rgb.blue)),e}function assignProfile(e){var t=new ActionDescriptor,n=new ActionReference;n.putEnumerated(sTID("document"),sTID("ordinal"),sTID("targetEnum")),t.putReference(sTID("null"),n),t.putString(sTID("profile"),e),executeAction(sTID("assignProfile"),t,DialogModes.NO)}function blendif(e,t,n,r){var o=new ActionDescriptor,i=new ActionReference;i.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("targetEnum")),o.putReference(sTID("null"),i);var c=new ActionDescriptor,s=new ActionList,a=new ActionDescriptor,l=new ActionReference;l.putEnumerated(sTID("channel"),sTID("channel"),sTID("gray")),a.putReference(sTID("channel"),l),a.putInteger(sTID("srcBlackMin"),0),a.putInteger(sTID("srcBlackMax"),0),a.putInteger(sTID("srcWhiteMin"),255),a.putInteger(sTID("srcWhiteMax"),255),a.putInteger(sTID("destBlackMin"),e),a.putInteger(sTID("destBlackMax"),t),a.putInteger(sTID("destWhiteMin"),n),a.putInteger(sTID("desaturate"),r),s.putObject(sTID("blendRange"),a),c.putList(sTID("blendRange"),s);var u=new ActionDescriptor;u.putUnitDouble(sTID("scale"),sTID("percentUnit"),100),c.putObject(sTID("layerEffects"),sTID("layerEffects"),u),o.putObject(sTID("to"),sTID("layer"),c),executeAction(sTID("set"),o,DialogModes.NO)}function checkTransparency(){return doc.suspendHistory("Transparent Check","checkTransparency_inner()"),undoSteps(1),!!transp}function checkTransparency_inner(){prefSave(),transp=!0;var e=function(e){return app.stringIDToTypeID(e)},t=new ActionDescriptor,n=new ActionDescriptor,r=new ActionReference,o=new ActionReference,i=new ActionReference;r.putProperty(e("channel"),e("selection")),t.putReference(e("null"),r),o.putEnumerated(e("channel"),e("channel"),e("transparencyEnum")),o.putEnumerated(e("layer"),e("ordinal"),e("merged")),n.putReference(e("to"),o),i.putEnumerated(e("channel"),e("channel"),e("transparencyEnum")),i.putEnumerated(e("layer"),e("ordinal"),e("merged")),n.putReference(e("source2"),i),t.putObject(e("to"),e("calculation"),n);try{executeAction(e("set"),t,DialogModes.NO),activeDocument.selection.invert();try{activeDocument.selection.bounds}catch(e){transp=!1}}catch(e){transp=!1}return prefReset(),activeDocument.selection.deselect(),transp}function clearAllGuides(){executeAction(sTID("clearAllGuides"),void 0,DialogModes.NO)}function cm2pt(e){return 28.3464566929*e}function cmyk2rgb(){doc.mode==DocumentMode.CMYK&&doc.convertProfile("eciRGB v2",Intent.RELATIVECOLORIMETRIC,!0,!1)}function createColorLayer(e,t,n,r,o,i,c,s){try{var a=new ActionDescriptor,l=new ActionReference;l.putClass(sTID("contentLayer")),a.putReference(sTID("null"),l);var u=new ActionDescriptor;u.putString(sTID("name"),e),u.putUnitDouble(sTID("opacity"),sTID("percentUnit"),r),u.putEnumerated(sTID("mode"),sTID("blendMode"),sTID(t)),u.putEnumerated(sTID("color"),sTID("color"),sTID(n));var D=new ActionDescriptor,p=new ActionDescriptor;if(p.putDouble(sTID("red"),i),p.putDouble(sTID("green"),c),p.putDouble(sTID("blue"),s),D.putObject(sTID("color"),sTID("RGBColor"),p),u.putObject(sTID("type"),sTID("solidColorLayer"),D),a.putObject(sTID("using"),sTID("contentLayer"),u),executeAction(sTID("make"),a,DialogModes.NO),gotoMask(),"invert"==o)return void executeAction(sTID("invert"),void 0,DialogModes.NO);if("none"==o)return void deleteMask();if("black"==o||"white"==o||"gray"==o)return void fill(o,"normal",100)}catch(e){logger(arguments.callee.name)}}function createGroup(e,t,n,r,o){try{var i=new ActionDescriptor,c=new ActionReference;if(c.putClass(sTID("layerSection")),i.putReference(sTID("null"),c),o){var s=new ActionReference;s.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("targetEnum")),i.putReference(sTID("from"),s)}var a=new ActionDescriptor;a.putString(sTID("name"),e),a.putUnitDouble(sTID("opacity"),sTID("percentUnit"),r),a.putEnumerated(sTID("color"),sTID("color"),sTID(n)),a.putEnumerated(sTID("mode"),sTID("blendMode"),sTID(t)),i.putObject(sTID("using"),sTID("layerSection"),a),i.putInteger(sTID("layerSectionStart"),351),i.putInteger(sTID("layerSectionEnd"),352),i.putString(sTID("name"),"Gruppe 3"),executeAction(sTID("make"),i,DialogModes.NO)}catch(e){logger(arguments.callee.name)}}function createLayer(e,t,n,r,o,i,c,s){try{var a=new ActionDescriptor,l=new ActionReference;l.putClass(sTID("adjustmentLayer")),a.putReference(sTID("null"),l);var u=new ActionDescriptor;if(u.putString(sTID("name"),e),u.putUnitDouble(sTID("opacity"),sTID("percentUnit"),o),u.putEnumerated(sTID("mode"),sTID("blendMode"),sTID(n)),u.putEnumerated(sTID("color"),sTID("color"),sTID(r)),u.putBoolean(sTID("group"),c),"levels"==t&&s){var D=new ActionDescriptor;D.putEnumerated(sTID("presetKind"),sTID("presetKindType"),sTID("presetKindDefault"));var p=new ActionList,I=new ActionDescriptor,T=new ActionReference;T.putEnumerated(sTID("channel"),sTID("channel"),sTID("composite")),I.putReference(sTID("channel"),T),I.putBoolean(sTID("auto"),!0),p.putObject(sTID("levelsAdjustment"),I),D.putList(sTID("adjustment"),p),u.putObject(sTID("type"),sTID(t),D)}else u.putClass(sTID("type"),sTID(t));if(a.putObject(sTID("using"),sTID("adjustmentLayer"),u),executeAction(sTID("make"),a,DialogModes.NO),"invert"==i)return void executeAction(sTID("invert"),void 0,DialogModes.NO);if("none"==i)return void deleteMask();if("black"==i||"white"==i||"gray"==i)return void fill(i,"normal",100)}catch(e){logger(arguments.callee.name)}}function deleteHistory(){var e=new ActionDescriptor,t=new ActionReference;t.putProperty(charIDToTypeID("HstS"),charIDToTypeID("CrnH")),e.putReference(charIDToTypeID("null"),t),executeAction(charIDToTypeID("Dlt "),e,DialogModes.NO)}function deleteMask(){try{var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("channel"),sTID("channel"),sTID("mask")),e.putReference(sTID("null"),t),executeAction(sTID("delete"),e,DialogModes.NO)}catch(e){logger(arguments.callee.name)}}function dublicate(e){var t=new ActionDescriptor,n=new ActionReference;n.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("targetEnum")),t.putReference(sTID("null"),n),t.putString(sTID("name"),e),t.putInteger(sTID("version"),5),executeAction(sTID("duplicate"),t,DialogModes.NO)}function emptyProtocoll(){var e=new ActionDescriptor;e.putEnumerated(cTID("null"),cTID("PrgI"),cTID("Al  ")),executeAction(cTID("Prge"),e,DialogModes.NO);for(var t=app.activeDocument.historyStates,n=t.length-1;n>=0;--n)t[n].snapshot&&(app.activeDocument.activeHistoryState=t[n],deleteHistory())}function fill(e,t,n,r,o,i){try{var c=new ActionDescriptor;if(c.putEnumerated(sTID("using"),sTID("fillContents"),sTID(e)),"color"==e){var s=new ActionDescriptor;s.putUnitDouble(sTID("hue"),sTID("angleUnit"),r),s.putDouble(sTID("saturation"),o),s.putDouble(sTID("brightness"),i),c.putObject(sTID("color"),sTID("HSBColorClass"),s)}c.putUnitDouble(sTID("opacity"),sTID("percentUnit"),n),c.putEnumerated(sTID("mode"),sTID("blendMode"),sTID(t)),executeAction(sTID("fill"),c,DialogModes.NO)}catch(e){logger(arguments.callee.name)}}function flattenImage(){executeAction(charIDToTypeID("FltI"),void 0,DialogModes.NO)}function getBitDepth(){if("BitsPerChannelType.EIGHT"==doc.bitsPerChannel)var e=8;else if(doc.bitsPerChannel==BitsPerChannelType.SIXTEEN)e=16;else{if(doc.bitsPerChannel!=BitsPerChannelType.THIRTYTWO)return!1;e=32}return e}function getScale(e){var t=1e6*e/(doc.width*doc.height);return Math.sqrt(t)}function gotoFill(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("channel"),sTID("channel"),sTID("RGB")),e.putReference(sTID("null"),t),e.putBoolean(sTID("makeVisible"),!1),executeAction(sTID("select"),e,DialogModes.NO)}function gotoLayer(e){var t=new ActionDescriptor,n=new ActionReference;"number"==typeof e?n.putIndex(charIDToTypeID("Lyr "),e):"string"==typeof e&&n.putName(sTID("layer"),e),t.putReference(sTID("null"),n),t.putBoolean(sTID("makeVisible"),!1),executeAction(sTID("select"),t,DialogModes.NO)}function gotoMask(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("channel"),sTID("channel"),sTID("mask")),e.putReference(sTID("null"),t),e.putBoolean(sTID("makeVisible"),!1),executeAction(sTID("select"),e,DialogModes.NO)}function gray2rgb(){doc.mode==DocumentMode.GRAYSCALE&&doc.convertProfile("eciRGB v2",Intent.RELATIVECOLORIMETRIC,!0,!1)}function hasBackground(){var e=new ActionReference;return e.putProperty(charIDToTypeID("Prpr"),charIDToTypeID("Bckg")),e.putEnumerated(charIDToTypeID("Lyr "),charIDToTypeID("Ordn"),charIDToTypeID("Back")),executeActionGet(e).getBoolean(charIDToTypeID("Bckg"))}function img_resize(e,t){var n;(prefSave(),prefSet(DialogModes.NO,Units.MM),doc.width>doc.height)?((n=new ActionDescriptor).putUnitDouble(sTID("width"),sTID("distanceUnit"),cm2pt(e)),executeAction(sTID("imageSize"),n,DialogModes.NO)):((n=new ActionDescriptor).putUnitDouble(sTID("height"),sTID("distanceUnit"),cm2pt(e)),executeAction(sTID("imageSize"),n,DialogModes.NO));doc.resolution>t&&t&&doc.resizeImage(void 0,void 0,t,ResampleMethod.PRESERVEDETAILS,0),prefReset()}function indexcolor2rgb(){doc.mode==DocumentMode.INDEXEDCOLOR&&doc.changeMode(ChangeMode.RGB)}function isSelectionActive(){var e=doc.selection;try{return!!e.bounds}catch(e){return!1}}function logger(e){debug&&time_start();var t="~/Desktop/SimonScript.log",n=File(t);n.exists||(n=new File(t));var r=new Date,o=("0"+r.getDate()).slice(-2)+"."+("0"+(r.getMonth()+1)).slice(-2)+"."+r.getFullYear()+" - "+(("0"+r.getHours()).slice(-2)+":"+("0"+r.getMinutes()).slice(-2)+":"+("0"+r.getSeconds()).slice(-2)),i=File(t);i.open("a",void 0,void 0),""!==i&&(i.writeln("-----------------------"),i.writeln(o),i.writeln("Doc: '"+doc.name+"'"),i.writeln("Function: '"+e+"'"),i.writeln(""),i.close()),debug&&time_stop(start)}function mergeLayers(){var e=new ActionDescriptor;executeAction(sTID("mergeLayersNew"),e,DialogModes.NO)}function mm2pt(e){return.283464566929*e}function moveLayer(e,t,n){gotoLayer(e);var r=app.activeDocument.activeLayer;gotoLayer(t);var o=app.activeDocument.activeLayer;if("up"==n)var i=ElementPlacement.PLACEBEFORE;if("down"==n)i=ElementPlacement.PLACEAFTER;if("inside"==n)i=ElementPlacement.INSIDE;if("PlaceAtBeginning"==n)i=ElementPlacement.PLACEATBEGINNING;if("PlaceAtEnd"==n)i=ElementPlacement.PLACEATEND;r.move(o,i)}function moveLayer3(e,t){"up"==e&&(e="next"),"down"==e&&(e="previous"),"top"==e&&(e="front"),"bottom"==e&&(e="back");for(var n=0;n<t;n++){var r=new ActionDescriptor,o=new ActionReference,i=new ActionReference;o.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("targetEnum")),r.putReference(sTID("null"),o),i.putEnumerated(sTID("layer"),sTID("ordinal"),sTID(e)),r.putReference(sTID("to"),i),executeAction(sTID("move"),r,DialogModes.NO)}}function nameLayer(e){try{doc.activeLayer.name=e}catch(e){logger(arguments.callee.name)}}function noProfile(){if(doc.colorProfileType==ColorProfile.NONE)try{app.bringToFront();var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("document"),sTID("ordinal"),sTID("targetEnum")),e.putReference(sTID("null"),t),e.putBoolean(sTID("manage"),!0),executeAction(sTID("assignProfile"),e,DialogModes.ALL)}catch(e){}}function prefReset(){app.preferences.rulerUnits=startRulerUnits,startDisplayDialogs==DialogModes.ERROR&&(startDisplayDialogs=DialogModes.NO),app.displayDialogs=startDisplayDialogs}function prefSave(){startDisplayDialogs=app.displayDialogs,startRulerUnits=app.preferences.rulerUnits}function prefSet(e,t){e||(alert("check prefSet"),e=DialogModes.NO),t||(alert("check prefSet"),t=Units.MM),app.displayDialogs=e,app.preferences.rulerUnits=t}function rasterSmartObject(){try{var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("targetEnum")),e.putReference(sTID("null"),t),executeAction(sTID("rasterizeLayer"),e,DialogModes.NO)}catch(e){logger(arguments.callee.name)}}function replace__RGB_RZ(e){var t=GetFileNameOnly(doc.name).replace(/(__RGB.*)$/g,e).replace(/(__RZ.*)$/g,e),n=new RegExp(e,"g");if(!t.match(n))t=t+e;return t}function resetImage(){executeAction(sTID("revert"),void 0,DialogModes.NO),emptyProtocoll()}function sRGB2eciRGB(){var e=doc.colorProfileName,t=new RegExp("^sRGB|Apple RGB|ColorMatch RGB");e.match(t)&&doc.convertProfile("eciRGB v2",Intent.RELATIVECOLORIMETRIC,!0,!1)}function saveRZ(e,t,n,r){var o=new Folder(e);o.exists||o.create();for(var i=o+"/"+t+(s=replace__RGB_RZ(r))+"."+n,c=File(i);c.exists;){var s;i=o+"/"+t+(s=s+"+")+"."+n,c=File(i)}if("tif"==n)(a=new TiffSaveOptions).alphaChannels=!0,a.byteOrder=ByteOrder.IBM,a.embedColorProfile=!0,a.imageCompression=TIFFEncoding.TIFFLZW,a.layers=!0,a.spotColors=!1,a.transparency=!0,a.annotations=!1;else if("jpg"==n){(a=new JPEGSaveOptions).embedColorProfile=!0,a.formatOptions=FormatOptions.STANDARDBASELINE,a.matte=MatteType.WHITE,a.quality=11}else if("psd"==n){var a;(a=new PhotoshopSaveOptions).alphaChannels=!1,a.annotations=!1,a.embedColorProfile=!0,a.layers=!0,a.spotColors=!1}doc.saveAs(new File(i),a,!1,Extension.LOWERCASE)}function selectAll(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("targetEnum")),e.putReference(sTID("null"),t),executeAction(sTID("selectAllLayers"),e,DialogModes.NO)}function selectAllLayers(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("targetEnum")),e.putReference(sTID("null"),t),executeAction(sTID("selectAllLayers"),e,DialogModes.NO)}function selectLayer(e,t){var n=new ActionDescriptor,r=new ActionReference;"down"!=e?r.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("forwardEnum")):r.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("backwardEnum")),n.putReference(sTID("null"),r),n.putBoolean(sTID("makeVisible"),!1);var o=0;for(o=1;o<=t;o+=1)executeAction(sTID("select"),n,DialogModes.NO)}function selectLayerUp(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("forwardEnum")),e.putReference(sTID("null"),t),e.putBoolean(sTID("makeVisible"),!1);var n=new ActionList;n.putInteger(108),e.putList(sTID("layerID"),n),executeAction(sTID("select"),e,DialogModes.NO)}function selectLayers(e){var t=new ActionDescriptor,n=new ActionReference;n.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("targetEnum")),t.putReference(sTID("null"),n),executeAction(sTID(e),t,DialogModes.NO)}function setBitDepth(e){var t=charIDToTypeID("CnvM"),n=new ActionDescriptor,r=charIDToTypeID("Dpth");n.putInteger(r,e),executeAction(t,n,DialogModes.NO)}function setDpi(e){var t=new ActionDescriptor;t.putUnitDouble(sTID("resolution"),sTID("densityUnit"),e),executeAction(sTID("imageSize"),t,DialogModes.NO)}function setMegaPixel(e){prefSave(),prefSet(DialogModes.NO,Units.PIXELS);var t=doc.width,n=doc.height,r=t*n,o=1e6*e,i=o/r;if(o<r)if(t>=n){var c=t*Math.sqrt(i);doc.resizeImage(c,void 0,void 0,ResampleMethod.PRESERVEDETAILS,0)}else{var s=Math.round(n*Math.sqrt(i));doc.resizeImage(void 0,s,void 0,ResampleMethod.PRESERVEDETAILS,0)}return prefReset(),""}function setSize(e,t){var n=new ActionDescriptor;n.putUnitDouble(sTID(e),sTID("distanceUnit"),mm2pt(t)),executeAction(sTID("imageSize"),n,DialogModes.NO)}function smartObject(){try{executeAction(stringIDToTypeID("newPlacedLayer"),void 0,DialogModes.NO)}catch(e){logger(arguments.callee.name)}}function smartObjectTransparencyIssue(){var e=doc.activeLayer.name;if(gotoLayer("Original"),tempRulerUnits=app.preferences.rulerUnits,app.preferences.rulerUnits=Units.PIXELS,"LayerKind.SMARTOBJECT"==doc.activeLayer.kind){if(doc.width<doc.height)var t=100*(doc.width+2)/doc.width;else t=100*(doc.height+2)/doc.height;alert(t),transformLayer("center",t)}if(gotoLayer("vorher Ebene"),doc.width<doc.height)t=100*(doc.width+2)/doc.width;else t=100*(doc.height+2)/doc.height;transformLayer("center",t),app.preferences.rulerunits=tempRulerUnits,gotoLayer(e);e=""}function startScriptFile(e,t){var n=new ActionDescriptor;n.putString(sTID("javaScriptName"),e),executeAction(sTID("AdobeScriptAutomation Scripts"),n,t)}function time_start(){start=(new Date).getTime()}function time_stop(e){var t=(new Date).getTime(),n="Done ("+Number((t-e)/1e3).toFixed(3)+" secs).";alert(n)}function transformLayer(e,t){var n=new ActionDescriptor;if("center"==e||"c"==e)var r="QCSAverage";if("topleft"==e||"tl"==e||"↖"==e)r="QCSCorner0";if("top"==e||"t"==e||"↑"==e)r="QCSSide0";if("topright"==e||"tr"==e||"↗"==e)r="QCSCorner1";if("right"==e||"r"==e||"→"==e)r="QCSSide1";if("bottomright"==e||"br"==e||"↘"==e)r="QCSCorner2";if("bottom"==e||"b"==e||"↓"==e)r="QCSSide2";if("bottomleft"==e||"bl"==e||"↙"==e)r="QCSCorner3";if("left"==e||"l"==e||"←"==e)r="QCSSide3";n.putEnumerated(sTID("freeTransformCenterState"),sTID("quadCenterState"),sTID(r));var o=new ActionDescriptor;o.putUnitDouble(sTID("horizontal"),sTID("pixelsUnit"),0),o.putUnitDouble(sTID("vertical"),sTID("pixelsUnit"),0),n.putObject(sTID("offset"),sTID("offset"),o),n.putUnitDouble(sTID("width"),sTID("percentUnit"),t),n.putUnitDouble(sTID("height"),sTID("percentUnit"),t),executeAction(sTID("transform"),n,DialogModes.NO)}function undoSteps(e){for(var t=0;t<e;t++)executeAction(charIDToTypeID("undo"),void 0,DialogModes.NO)}app.documents.length>0&&(doc=app.activeDocument,docs=app.documents),f=!1,t=!0,debug=!1;