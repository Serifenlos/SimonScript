/*
// BEGIN__HARVEST_EXCEPTION_ZSTRING
<javascriptresource>
<name>[11F BW] Größenberechnung</name>
<about>Bilderwelt Größenberechnung | By Simon Adrian | http://www.SimonAdrian.de</about>
<category>11Freunde</category>
</javascriptresource>
// END__HARVEST_EXCEPTION_ZSTRING
*/
// @include "functions/basic.jsx";
// @include "functions/loopFiles.jsx";
// @include "functions/save.jsx";
if(0==app.documents.length){inputFolder=Folder.selectDialog("Bitte wähle den Input-Ordner aus\n Unterordner werden nicht ausgewertet\nDie ausgespielten Dateien werden im Unterorder 'output' abgelegt");var fileList=inputFolder.getFiles(/.+\.(jpg|tif|psd|psb|bmp|gif|png|)$/i),outputFolder=new Folder(inputFolder+"/output");outputFolder.exists||outputFolder.create();for(var j=0;j<fileList.length;j++){var thisFile=fileList[j],thisFileName=(thisFileName=GetFileNameOnly(thisFile.name)).replace(/(__RGB.*)$/g,""),doc_file=new File(thisFile);app.open(doc_file);var doc=app.activeDocument;process_BW(thisFile),doc.close(SaveOptions.DONOTSAVECHANGES)}}else alert("Abruch\nschließe bitte vorerst alle Dokumente!");
///////////////////////*////////////////////
function process_BW(e){var t=doc.width,i=doc.height;if(t>i)
// alert("breit")
var l=(t/i).toFixed(2);else
// alert("hoch")
l=(i/t).toFixed(2);if(l>=1.48&&l<=1.52)for(var s=[180,150,120,90,75,60,45,30],a=get_longSite(),r=0;r<s.length;r++){flattenImage();try{getBitDepth(!1)&&setBitDepth(8)}catch(e){}if(clearAllGuides(),(f=parseFloat(s[r]))<=parseFloat(a)){if(img_resize(f,300),180==f)var o="180x120";else if(150==f)o="150x100";else if(120==f)o="120x80";else if(90==f)o="90x60";else if(75==f)o="75x50";else if(60==f)o="60x40";else if(45==f)o="45x30";else if(30==f)o="30x20";newFilePath=new File(outputFolder+"/"+thisFileName+"__"+o),saveFile_JPG(11,!0,"FormatOptions.OPTIMIZEDBASELINE","MatteType.NONE")}resetImage()}else if(l>=1.31&&l<=1.35)for(s=[180,160,120,100,80,60,40],a=get_longSite(),r=0;r<s.length;r++){flattenImage();try{getBitDepth(!1)&&setBitDepth(8)}catch(e){}if(clearAllGuides(),(f=parseFloat(s[r]))<=parseFloat(a)){if(img_resize(f,300),180==f)o="180x135";else if(160==f)o="160x120";else if(120==f)o="120x90";else if(100==f)o="100x75";else if(80==f)o="80x60";else if(60==f)o="60x45";else if(40==f)o="40x30";newFilePath=new File(outputFolder+"/"+thisFileName+"__"+o),saveFile_JPG(11,!0,"FormatOptions.OPTIMIZEDBASELINE","MatteType.NONE")}resetImage()}else if(l>=.98&&l<=1.02)for(s=[140,120,100,80,60,50,40],a=get_longSite(),r=0;r<s.length;r++){flattenImage();try{getBitDepth(!1)&&setBitDepth(8)}catch(e){}if(clearAllGuides(),(f=parseFloat(s[r]))<=parseFloat(a)){if(img_resize(f,300),140==f)o="140x140";else if(120==f)o="120x120";else if(100==f)o="100x100";else if(80==f)o="80x80";else if(60==f)o="60x60";else if(50==f)o="50x50";else if(40==f)o="40x40";newFilePath=new File(outputFolder+"/"+thisFileName+"__"+o),saveFile_JPG(11,!0,"FormatOptions.OPTIMIZEDBASELINE","MatteType.NONE")}resetImage()}else if(l>=2.48&&l<=2.52)for(s=[250,225,200,175,150,125,100,62.5],a=get_longSite(),r=0;r<s.length;r++){flattenImage();try{getBitDepth(!1)&&setBitDepth(8)}catch(e){}if(clearAllGuides(),(f=parseFloat(s[r]))<=parseFloat(a)){if(img_resize(f,300),250==f)o="250x100";else if(225==f)o="225x90";else if(200==f)o="200x80";else if(175==f)o="175x70";else if(150==f)o="150x60";else if(125==f)o="125x50";else if(100==f)o="100x40";else if(62.5==f)o="62x25";newFilePath=new File(outputFolder+"/"+thisFileName+"__"+o),saveFile_JPG(11,!0,"FormatOptions.OPTIMIZEDBASELINE","MatteType.NONE")}resetImage()}else if(l>=1.4&&l<=1.44)for(s=[118.9,84.1,59.4,42,29.7],a=get_longSite(),r=0;r<s.length;r++){flattenImage();try{getBitDepth(!1)&&setBitDepth(8)}catch(e){}var f;if(clearAllGuides(),(f=parseFloat(s[r]))<=parseFloat(a)){if(img_resize(f,300),118.9==f)o="A0";else if(84.1==f)o="A1";else if(59.4==f)o="A2";else if(42==f)o="A3";else if(29.7==f)o="A4";newFilePath=new File(outputFolder+"/"+thisFileName+"__"+o),saveFile_JPG(11,!0,"FormatOptions.OPTIMIZEDBASELINE","MatteType.NONE")}resetImage()}}function get_longSite(){prefSave(),prefSet(DialogModes.NO,Units.CM);var e=doc.width,t=doc.height;if(e>t)var i=e;else i=t;return prefReset(),parseFloat(i).toFixed(0)}