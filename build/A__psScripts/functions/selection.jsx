function mask2image(e){if(1===layer_selectedIDX_get().length&&hasLayerMask()){var t=layer_getName(getActiveLayerIndex());gotoMask(),loadSelectionOfMask(),select_invert(),layer_create(e+" ("+t+")",100,!0,"normal"),fill("black","normal",100),selection_deselect()}else alert("Abbruch!\nwähle genau eine Ebene mit Maske aus")}function select_Farbbereich(e){var t=new ActionDescriptor;t.putEnumerated(s2t("colors"),s2t("colors"),s2t(e)),t.putInteger(s2t("colorModel"),0),executeAction(s2t("colorRange"),t,DialogModes.NO)}function select_all(){var e=new ActionDescriptor,t=new ActionReference;t.putProperty(s2t("channel"),s2t("selection")),e.putReference(s2t("null"),t),e.putEnumerated(s2t("to"),s2t("ordinal"),s2t("allEnum")),executeAction(s2t("set"),e,DialogModes.NO)}function select_invert(){executeAction(s2t("inverse"),void 0,DialogModes.NO)}function select_luminance(){const e=workingProfile_get("Gray"),t=doc.colorProfileName;gamma_L=["eciRGB v2","eciRGB v2 ICCv4"],gamma_18=["sRGB IEC61966-2.1","ProPhoto RGB","Display P3","image P3","Apple RGB","ColorMatch RGB"],gamma_22=["Adobe RGB (1998)","BestRGB","Beta RGB","DonRGB4.icm","MaxRGB","Russell RGB"],array_contains(gamma_18,t)&&"Gray Gamma 1.8"!=e&&workingProfile_set("Gray","Gray Gamma 1.8"),array_contains(gamma_22,t)&&"Gray Gamma 2.2"!=e&&workingProfile_set("Gray","Gray Gamma 2.2"),array_contains(gamma_L,t)&&workingProfile_set("Gray","Gray-elle-V4-labl.icc"),array_contains(gamma_18,t)||array_contains(gamma_22,t)||array_contains(gamma_L,t)||alert("Vorsicht\nDie Helligkeitsverteilung könnte fehlerhaft sein.\nfehlende Info zum Gamma von '"+t+"'");var n=new ActionDescriptor,o=new ActionReference,a=new ActionReference;o.putProperty(s2t("channel"),s2t("selection")),n.putReference(s2t("null"),o),a.putEnumerated(s2t("channel"),s2t("channel"),s2t("RGB")),n.putReference(s2t("to"),a),executeAction(s2t("set"),n,DialogModes.NO),e!=workingProfile_get("Gray")&&workingProfile_set("Gray",e)}function select_motiv(){var e=new ActionDescriptor;e.putBoolean(s2t("sampleAllLayers"),!0),executeAction(s2t("autoCutout"),e,DialogModes.NO)}function select_outOfGamut(e,t){var n=layer_selectedIDX_get();cancel=!1;const o=getMeta_softproof()[0],a=workingProfile_get("CMYK");void 0!==o?(a!=o&&workingProfile_set("CMYK",o),gotoFill(),selection_loop((function(){select_Farbbereich("outOfGamut")})),a!=o&&workingProfile_set("CMYK",a),cancel||("Selection"==t?layer_selectedIDX_set(n):(gotoLayer(n[n.length-1]),selection2mask(e)))):alert("kein Softproof eingestellt")}function select_saturation(e,t,n,o){var a=layer_selectedIDX_get();cancel=!1,selection_loop((function(){channel_setSaturation(n,t)})),cancel||("selection"==o?(layer_selectedIDX_set(a),channel2selection("saturation"),"unbunt"==e&&select_invert(),channel_delete("saturation")):(gotoLayer(a[a.length-1]),channel2mask("saturation",e),"unbunt"==e&&(gotoMask(),invert(),gotoFill()),channel_delete("saturation")))}function select_sky(e){var t=new ActionDescriptor;t.putBoolean(s2t("sampleAllLayers"),e),executeAction(s2t("selectSky"),t,DialogModes.NO)}function selection2mask(e){for(var t=1;layer_checkExistence(layer_getIDXbyString(e+" "+t)[0]);)t++;createGroup(e+" "+t,"passThrough","none",100,f),maskFromSelection()}function selection_check(){var e=!0;try{activeDocument.selection.bounds}catch(t){e=!1}return e}function selection_deselect(){var e=new ActionDescriptor,t=new ActionReference;t.putProperty(s2t("channel"),s2t("selection")),e.putReference(s2t("null"),t),e.putEnumerated(s2t("to"),s2t("ordinal"),s2t("none")),executeAction(s2t("set"),e,DialogModes.NO)}function selection_loop(e){var t;try{e()}catch(n){t=getActiveLayerIndex(),select_nextLayer_simple("down",f),function n(){var o=getActiveLayerIndex();try{e()}catch(e){if(o===t)return alert("keine geeignete Ebene gefunden"),void(cancel=!0);select_nextLayer_simple("down",f),n()}}()}}