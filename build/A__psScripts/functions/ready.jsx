function DodgeBurn_highlow(e){createGroup("Tiefen","passThrough","gray",100,f),createLayer("Burn ▽","colorLookup","normal","gray",100,"black",f,f),LUT_burn(),blendif("current",0,0,0,255),createLayer("Dodge ▽","colorLookup","normal","gray",100,"black",f,f),LUT_dodge(),blendif("current",0,0,0,255),selectParent(),createGroup("Dodge & Burn △▽","passThrough","gray",100,t),createLayer("Burn △","colorLookup","normal","gray",100,"black",f,f),LUT_burn(),blendif("current",0,255,255,255),createGroup("Lichter","passThrough","gray",100,t),createLayer("Dodge △","colorLookup","normal","gray",100,"black",f,f),LUT_dodge(),blendif("current",0,255,255,255),selectParent(),selectParent(),e&&toogleOpenCloseSet()}function DodgeBurn_highmidlow(e){createGroup("Tiefen","passThrough","gray",100,f),createLayer("Burn ▽","colorLookup","normal","gray",100,"black",f,f),LUT_burn(),blendif("current",0,0,0,255),createLayer("Dodge ▽","colorLookup","normal","gray",100,"black",f,f),LUT_dodge(),blendif("current",0,0,0,255),selectParent(),createGroup("Dodge & Burn △◊▽","passThrough","gray",100,t),createLayer("Burn ⬨","colorLookup","normal","gray",100,"black",f,f),LUT_burn(),blendif("current",20,202,109,240),createGroup("Mitten","passThrough","gray",100,t),createLayer("Dodge ⬨","colorLookup","normal","gray",100,"black",f,f),LUT_dodge(),blendif("current",20,202,109,240),selectParent(),selectParent(),createLayer("Burn △","colorLookup","normal","gray",100,"black",f,f),LUT_burn(),blendif("current",0,255,255,255),createGroup("Lichter","passThrough","gray",100,t),createLayer("Dodge △","colorLookup","normal","gray",100,"black",f,f),LUT_dodge(),blendif("current",0,255,255,255),selectParent(),selectParent(),e&&toogleOpenCloseSet()}function burn(){createLayer("Burn","colorLookup","normal","gray",100,"black",f,f),LUT_burn()}function dodge(){createLayer("Dodge","colorLookup","normal","gray",100,"black",f,f),LUT_dodge()}function dodgeburn(){createGroup("Dodge & Burn","passThrough","gray",100,f),createLayer("Burn","colorLookup","normal","gray",100,"black",f,f),LUT_burn(),createLayer("Dodge","colorLookup","normal","gray",100,"black",f,f),LUT_dodge()}function dodgeburn_mid(){createGroup("Dodge & Burn ⬨","passThrough","gray",100,f),createLayer("Burn ⬨","colorLookup","normal","gray",100,"black",f,f),LUT_burn(),blendif("current",20,202,109,240),createLayer("Dodge ⬨","colorLookup","normal","gray",100,"black",f,f),LUT_dodge(),blendif("current",20,202,109,240)}function dodgeburn_toggle(){try{var e=doc.activeLayer,r=getActiveLayerIndex();e.kind==LayerKind.COLORLOOKUP&&(/burn/i.test(e.name)?(selectLayer("up",1),/dodge/i.test(doc.activeLayer.name)||(gotoLayer(r),selectLayer("down",1),/dodge/i.test(doc.activeLayer.name)||gotoLayer(r))):/dodge/i.test(e.name)&&(selectLayer("down",1),/burn/i.test(doc.activeLayer.name)||(gotoLayer(r),selectLayer("up",1),/burn/i.test(doc.activeLayer.name)||gotoLayer(r))))}catch(e){}}function freisteller_allHG(){for(var e=app.activeDocument,r=app.foregroundColor,t=r.hsb.hue,a=r.hsb.saturation,o=r.hsb.brightness,l=0;l<app.documents.length;l++){app.activeDocument=app.documents[l];app.activeDocument;try{if(app.activeDocument.layers.getByName("Freisteller helper"))try{var n=layer_selectedIDX_get();gotoLayer("Freisteller helper"),layer_getSolidFillColor()[0]==app_getForegroundColor()[0]?layer_getSolidFillColor()[1]==app_getForegroundColor()[1]&&layer_getSolidFillColor()[2]==app_getForegroundColor()[2]&&(isVisible()?hide():makeVisible()):layer_solidColorHSB_change(t,a,o),layer_selectedIDX_set(n)}catch(e){}}catch(e){}}app.activeDocument=e}function freisteller_button(){var e=layer_selectedIDX_get();start_closedSets=[];var r=!1;if(getMeta_3("isWoodwing"))r=Boolean(getMeta_3("isWoodwing"));try{if(app.activeDocument.layerSets.getByName("Freisteller"))try{r?alert("ist schon als Freisteller angelegt"):(app.activeDocument.suspendHistory("Freisteller SaveRGB","freisteller_saveRGB()"),app.activeDocument.save())}catch(e){alert(e)}}catch(e){app.activeDocument.suspendHistory("Freisteller-Gruppe","freisteller_createGroup()");try{if(r){if(app.activeDocument.suspendHistory("getClosedSets","var start_closedSets = getClosedSets()"),getMeta_3("woodwing_RGB"))var a=getMeta_3("woodwing_RGB");if(getMeta_3("woodwing_file"))var o=getMeta_3("woodwing_file");if(getMeta_3("idDocName"))var l=getMeta_3("idDocName");BridgeTalkMessage_openDocID(l,o,!1),replaceMeta_3_suffix("woodwing_file","jpg","psd"),replaceMeta_3_suffix("woodwing_RGB","jpg","psd"),app.activeDocument.suspendHistory("Freisteller: 2 Ebenen","freisteller_reduce2layers()"),saveMultiformat(new File(a),"psd",t,null,f,t),undoSteps(1),replaceMeta_3_suffix("woodwing_file","jpg","psd"),replaceMeta_3_suffix("woodwing_RGB","jpg","psd")}else app.activeDocument.suspendHistory("Freisteller SaveRGB","freisteller_saveRGB()"),app.activeDocument.save()}catch(e){}}app.activeDocument.suspendHistory("toogleOpenCloseSet_byArray_loop","toogleOpenCloseSet_byArray_loop(start_closedSets)"),layer_selectedIDX_set(e)}function toogleOpenCloseSet_byArray_loop(e){for(var r=0;r<e.length;r++)try{if(gotoLayer(e[r]),myALayerIDX=getActiveLayerIndex(),myGroupP=app.activeDocument.activeLayer,isLayerSet(myALayerIDX))getNbOfChilds()>1&&(isSetOpened1(myGroupP)?closeGroup(myGroupP):openGroup1(myGroupP));else{myGroupP=app.activeDocument.activeLayer.parent;try{app.activeDocument.activeLayer=myGroupP}catch(e){return}getNbOfChilds()>1&&"Document"!=myGroupP.typename&&(isSetOpened1(myGroupP)?closeGroup(myGroupP):openGroup1(myGroupP))}}catch(e){alert("toogleOpenCloseSet_byArray_loop: "+e)}}function closeDoc(e){try{app.documents.getByName(decodeURI(e)).close(SaveOptions.DONOTSAVECHANGES)}catch(r){ssDebug&&alert("closeDoc: "+e+" :--: "+r)}}function BridgeTalkMessage_openDocID(e,r,t){var a=new BridgeTalk;a.target="indesign",a.body=runID.toSource()+"('"+e+"','"+r+"','"+t+"');",a.onResult=function(e){},a.send(10)}function runID(e,r,t){try{if(function(e){for(var r=!1,t=0;t<app.documents.length;t++)if(-1!==app.documents[t].name.indexOf(e)){r=!0,app.activeDocument=app.documents[t];break}return r}(e))app.activeDocument.links.itemByName(r).editOriginal();else alert("kein Focus auf der Datei?")}catch(e){}return" "}function freisteller_createGroup(){var e=layer_selectedIDX_get();selectLayers("selectAllLayers"),createGroup("Freisteller","passThrough","none",100,t);try{isSelectionActive()&&maskFromSelection()}catch(e){}toogleOpenCloseSet();var r=app.activeDocument.layerSets.getByName("Freisteller");createColorLayer("Freisteller helper","normal","none",100,"none",128,128,128),hide(),app.activeDocument.activeLayer.move(r,ElementPlacement.PLACEAFTER),layer_selectedIDX_set(e)}function freisteller_deFrei(){try{if(app.activeDocument.layerSets.getByName("Freisteller")){var e=layer_selectedID_get();try{var r=!1;if(getMeta_3("isWoodwing"))r=Boolean(getMeta_3("isWoodwing"));try{gotoLayer("Freisteller"),ungroup(),gotoLayer("Freisteller helper"),deleteActiveLayer()}catch(e){}if(r){if(getMeta_3("woodwing_RGB"))var a=getMeta_3("woodwing_RGB");if(getMeta_3("woodwing_file"))var o=getMeta_3("woodwing_file");if(getMeta_3("idDocName"))var l=getMeta_3("idDocName");BridgeTalkMessage_openDocID(l,o,!1),replaceMeta_3_suffix("woodwing_file","psd","jpg"),replaceMeta_3_suffix("woodwing_RGB","psd","jpg"),saveMultiformat(new File(a),"jpg",t,RZ_qualityJPG,f,f)}else{var n=new Folder(doc.path),i=GetFileNameOnly(doc.name),c=/(?:\.([^.]+))?$/.exec(doc.name)[1],s=new File(n+"/"+i+"-frei."+c);s.exists&&s.remove()}}catch(e){alert(e)}layer_selectedID_set(e)}}catch(e){return alert("Abbruch!\nkeine Ebene names 'Freisteller' gefunden\n"+e),!1}}function BridgeTalkMessage_openDocID(e,r,t){var a=new BridgeTalk;a.target="indesign",a.body=runID.toSource()+"('"+e+"','"+r+"','"+t+"');",a.onResult=function(e){},a.send(10)}function runID(e,r,t){try{if(function(e){for(var r=!1,t=0;t<app.documents.length;t++)if(-1!==app.documents[t].name.indexOf(e)){r=!0,app.activeDocument=app.documents[t];break}return r}(e))app.activeDocument.links.itemByName(r).editOriginal();else alert("kein Focus auf der Datei?")}catch(e){}return" "}function freisteller_reduce2layers(){try{doc.layers.getByName("Freisteller helper")&&hide("Freisteller helper")}catch(e){}try{selectLayers("selectAllLayers"),selectLayerBySelector("Freisteller","remove"),layer_mergeLayers(),layer_makeBackground(),dublicate("frei"),gotoLayer("Freisteller");var e=getMaskVisibility();loadSelectionOfMask(),gotoLayer("frei");try{isSelectionActive()&&maskFromSelection()}catch(e){}layer_delete("Freisteller"),e?(makeVisible("frei"),hide(0),gotoLayer("frei")):(makeVisible(0),hide("frei"),gotoLayer(0))}catch(e){alert("Error freisteller_reduce2layers: "+e)}}function freisteller_saveRGB(){var e=layer_selectedIDX_get(),r=null;if(gotoLayer("Freisteller"),hasLayerMask()){var a=getMaskVisibility();if(setMaskVisibility(!0),"Freisteller helper"==getLayerName(1)){r=isVisibleIDX(1);makeVisByIndex(1,!1)}var o=app.activeDocument.path+"/"+GetFileNameOnly(app.activeDocument.name)+"-frei";savePSD_v2(new File(o),t,t,t,f),setMaskVisibility(!1),null!=r&&makeVisByIndex(1,r),setMaskVisibility(a)}layer_selectedIDX_set(e)}function himmelmaske(e,r){var t=layer_selectedIDX_get();cancel=!1,selection_loop((function(){select_sky(!1)})),cancel||("Selection"==r?(layer_selectedIDX_set(t),"nicht Himmel"==e&&select_invert()):(gotoLayer(t[t.length-1]),selection2mask(e),"nicht Himmel"==e&&(gotoMask(),invert(),gotoFill())))}function motivmaske(e,r){var t=layer_selectedIDX_get();cancel=!1,selection_loop((function(){select_motiv()})),cancel||("Selection"==r?(layer_selectedIDX_set(t),"nicht Motiv"==e&&select_invert()):(gotoLayer(t[t.length-1]),selection2mask(e),"nicht Motiv"==e&&(gotoMask(),invert(),gotoFill())))}function startschuss(e,r){debug&&time_start(),indexcolor2rgb(),noProfile(),gray2rgb(),cmyk2rgb(),sRGB2eciRGB(),8!=getBitDepth()&&dialog_bitdepth();try{if(void 0!==r&&null!=r&&null!=r.length&&r.length>0&&r[0][0])for(var a=0;a<r.length;a++){var o=r[a];if(hasBackground())l=o[1];else var l=o[1]+=1;var n=o[0],i=getLayerName(l),c=o[2],s=o[3];c!=s&&n==i&&(s?makeVisible(l):hide(l))}}catch(e){debug&&alert("Error startschuss layerOptions: "+e)}try{"undefined"!=typeof myPsDoc&&setSize("width",e[6],"points")}catch(e){debug&&alert("error startschuss setSize: "+e)}try{if(hasBackground()&&0!=getActiveLayerIndex()){var y=doc.activeLayer.name;gotoLayer(0),nameLayer("HG"),gotoLayer(y);y=""}}catch(e){debug&&alert("error startschuss hasBackground: "+e)}try{nameLayer("Original")}catch(e){debung&&alert("error startschuss nameLayer: "+e)}try{void 0!==e&&(0===e[0]&&0===e[1]&&0===e[2]&&0===e[3]||(0===e[3]&&0===e[0]||g(e[3],e[0],Units.POINTS,AnchorPosition.BOTTOMRIGHT),0===e[1]&&0===e[2]||g(e[1],e[2],Units.POINTS,AnchorPosition.TOPLEFT),createColorLayer("Anbau","normal","none",100,"none",128,128,128),moveLayer3("down",1),selectLayers("selectAllLayers")))}catch(e){debug&&alert(alert("error startschuss _imageDimension: "+e))}function g(e,r,t,a){startRulerUnits=app.preferences.rulerUnits,app.preferences.rulerUnits=t;var o=doc.width.value+e,l=doc.height.value+r;doc.resizeCanvas(o,l,a),app.preferences.rulerUnits=startRulerUnits}selectLayers("selectAllLayers"),smartObject(),nameLayer("Original"),createGroup("vorher","passThrough","none",100,t),dublicate("nachher"),gotoLayer("vorher"),selectLayer("down",1),nameLayer("vorher Ebene"),rasterSmartObject(),toogleOpenCloseSet(),selectLayer("up",1),createColorLayer("Weiss","normal","none",100,"none",255,255,255),moveLayer("Weiss","Original","down"),createGroup("Einstellungen","passThrough","none",100,f),createLayer("AutoTonwert","levels","normal","gray",100,"none",f,t),toogleVisibility(),createLayer("Gradation neutral","curves","normal","gray",100,"none",f,f),DodgeBurn_highmidlow(!0),selectLayer("up",1),createLayer("Selektive Farbe","selectiveColor","normal","violet",100,"",f,f),createLayer("Sättigung Farbe","hueSaturation","normal","blue",100,"",f,f),createLayer("Sättigung Luminanz","hueSaturation","luminosity","green",100,"",f,f),createLayer("Farbe in Balance","colorBalance","normal","yellowColor",100,"",f,f),createLayer("Gradation Kontrast","curves","normal","orange",100,"",f,f),createLayer("Dynamik","vibrance","normal","red",100,"",f,f),gotoLayer("Gradation neutral"),debug&&time_stop(start)}function tiefenmaske(e,r,t){var a=layer_selectedIDX_get();if(cancel=!1,e)layer_mergeVisible(e);else{if("LayerKind.SMARTOBJECT"!=doc.activeLayer.kind&&"LayerKind.NORMAL"!=doc.activeLayer.kind)return void alert("Abruch\n Eine Tiefenmakse von dieser Ebene kann nciht erstellt werden.");layer_copyLayers(),"LayerKind.SMARTOBJECT"==doc.activeLayer.kind&&rasterSmartObject(),layer_selectedIDX_get().length>1&&layer_mergeLayers()}nameLayer("helper__depthMask_image");for(var o=hasBackground()?0:1;layer_checkExistence(o);)o++;moveLayer("helper__depthMask_image",parseInt(o-1),"up"),gotoLayer("helper__depthMask_image"),selection_loop((function(){neural_depthmap2()})),nameLayer("layer__depthMask_map"),select_luminance(),layer_delete(),gotoLayer("helper__depthMask_image"),layer_delete(),cancel||("Selection"==t?(layer_selectedIDX_set(a),"nicht Tiefe"==r&&select_invert()):(gotoLayer(a[a.length-1]),selection2mask(r),"nicht Tiefe"==r&&(gotoMask(),invert(),gotoFill())))}function tiefenmakse_part1(e){layer_selectedIDX_get();if(e||layer_selectedIDX_get().length>1){e?layer_mergeVisible(e):(layer_copyLayers(),layer_mergeLayers()),nameLayer("helper__depthMask_image");for(var r=hasBackground()?0:1;layer_checkExistence(r);)r++;moveLayer("helper__depthMask_image",parseInt(r-1),"up"),gotoLayer("helper__depthMask_image")}else{for(layer_checkExistence(layer_getIDXbyString("Original")[0])?gotoLayer("Original"):gotoLayer(layer_selectedIDX_get()[layer_selectedIDX_get().length-1]);doc.activeLayer.kind!=LayerKind.NORMAL;)gotoLayer(getActiveLayerIndex()-1);doc.activeLayer.kind!=LayerKind.SmartObject&&(executeAction(sTID("copyToLayer"),void 0,DialogModes.NO),nameLayer("helper__depthMask_image"))}}function tiefenmakse_part2(e){nameLayer("layer__depthMask_map"),select_luminance(),layer_delete(),gotoLayer("helper__depthMask_image"),layer_delete(),createGroup("Tiefe","passThrough","none",100,f),maskFromSelection(),layer_checkExistence(layer_getIDXbyString("Dodge & Burn △◊▽")[0])&&moveLayer("Tiefe","Dodge & Burn △◊▽","up"),gotoLayer("Tiefe")}