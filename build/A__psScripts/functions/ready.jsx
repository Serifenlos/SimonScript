function DodgeBurn_highlow(e){createGroup("Tiefen","passThrough","gray",100,f),createLayer("Burn ▽","colorLookup","normal","gray",100,"black",f,f),LUT_burn(),blendif("current",0,0,0,255),createLayer("Dodge ▽","colorLookup","normal","gray",100,"black",f,f),LUT_dodge(),blendif("current",0,0,0,255),selectParent(),createGroup("Dodge & Burn △▽","passThrough","gray",100,t),createLayer("Burn △","colorLookup","normal","gray",100,"black",f,f),LUT_burn(),blendif("current",0,255,255,255),createGroup("Lichter","passThrough","gray",100,t),createLayer("Dodge △","colorLookup","normal","gray",100,"black",f,f),LUT_dodge(),blendif("current",0,255,255,255),selectParent(),selectParent(),e&&toogleOpenCloseSet()}function DodgeBurn_highmidlow(e){createGroup("Tiefen","passThrough","gray",100,f),createLayer("Burn ▽","colorLookup","normal","gray",100,"black",f,f),LUT_burn(),blendif("current",0,0,0,255),createLayer("Dodge ▽","colorLookup","normal","gray",100,"black",f,f),LUT_dodge(),blendif("current",0,0,0,255),selectParent(),createGroup("Dodge & Burn △◊▽","passThrough","gray",100,t),createLayer("Burn ⬨","colorLookup","normal","gray",100,"black",f,f),LUT_burn(),blendif("current",20,202,109,240),createGroup("Mitten","passThrough","gray",100,t),createLayer("Dodge ⬨","colorLookup","normal","gray",100,"black",f,f),LUT_dodge(),blendif("current",20,202,109,240),selectParent(),selectParent(),createLayer("Burn △","colorLookup","normal","gray",100,"black",f,f),LUT_burn(),blendif("current",0,255,255,255),createGroup("Lichter","passThrough","gray",100,t),createLayer("Dodge △","colorLookup","normal","gray",100,"black",f,f),LUT_dodge(),blendif("current",0,255,255,255),selectParent(),selectParent(),e&&toogleOpenCloseSet()}function burn(){createLayer("Burn","colorLookup","normal","gray",100,"black",f,f),LUT_burn()}function dodge(){createLayer("Dodge","colorLookup","normal","gray",100,"black",f,f),LUT_dodge()}function dodgeburn(){createGroup("Dodge & Burn","passThrough","gray",100,f),createLayer("Burn","colorLookup","normal","gray",100,"black",f,f),LUT_burn(),createLayer("Dodge","colorLookup","normal","gray",100,"black",f,f),LUT_dodge()}function dodgeburn_mid(){createGroup("Dodge & Burn ⬨","passThrough","gray",100,f),createLayer("Burn ⬨","colorLookup","normal","gray",100,"black",f,f),LUT_burn(),blendif("current",20,202,109,240),createLayer("Dodge ⬨","colorLookup","normal","gray",100,"black",f,f),LUT_dodge(),blendif("current",20,202,109,240)}function dodgeburn_toggle(){try{var e=doc.activeLayer,r=getActiveLayerIndex();e.kind==LayerKind.COLORLOOKUP&&(/burn/i.test(e.name)?(selectLayer("up",1),/dodge/i.test(doc.activeLayer.name)||(gotoLayer(r),selectLayer("down",1),/dodge/i.test(doc.activeLayer.name)||gotoLayer(r))):/dodge/i.test(e.name)&&(selectLayer("down",1),/burn/i.test(doc.activeLayer.name)||(gotoLayer(r),selectLayer("up",1),/burn/i.test(doc.activeLayer.name)||gotoLayer(r))))}catch(e){}}function freisteller_allHG(){for(var e=app.activeDocument,r=app.foregroundColor,t=r.hsb.hue,a=r.hsb.saturation,o=r.hsb.brightness,n=0;n<app.documents.length;n++){app.activeDocument=app.documents[n];app.activeDocument;try{if(app.activeDocument.layers.getByName("Freisteller helper"))try{var i=layer_selectedIDX_get();gotoLayer("Freisteller helper"),layer_getSolidFillColor()[0]==app_getForegroundColor()[0]?layer_getSolidFillColor()[1]==app_getForegroundColor()[1]&&layer_getSolidFillColor()[2]==app_getForegroundColor()[2]&&(isVisible()?hide():makeVisible()):layer_solidColorHSB_change(t,a,o),layer_selectedIDX_set(i)}catch(e){}}catch(e){}}app.activeDocument=e}function freisteller_button(){var e=layer_selectedIDX_get();start_closedSets=[];var r=!1;if(getMeta_3("isWoodwing"))r=Boolean(getMeta_3("isWoodwing"));try{if(app.activeDocument.layerSets.getByName("Freisteller"))try{r?alert("ist schon als Freisteller angelegt"):(app.activeDocument.suspendHistory("Freisteller SaveRGB","freisteller_saveRGB()"),app.activeDocument.save())}catch(e){alert(e)}}catch(e){app.activeDocument.suspendHistory("Freisteller-Gruppe","freisteller_createGroup()");try{if(r){if(app.activeDocument.suspendHistory("getClosedSets","var start_closedSets = getClosedSets()"),getMeta_3("woodwing_RGB"))var a=getMeta_3("woodwing_RGB");if(getMeta_3("woodwing_file"))var o=getMeta_3("woodwing_file");if(getMeta_3("idDocName"))var n=getMeta_3("idDocName");BridgeTalkMessage_openDocID(n,o,!1),replaceMeta_3_suffix("woodwing_file","jpg","psd"),replaceMeta_3_suffix("woodwing_RGB","jpg","psd"),app.activeDocument.suspendHistory("Freisteller: 2 Ebenen","freisteller_reduce2layers()"),saveMultiformat(new File(a),"psd",t,null,f,t),undoSteps(1),replaceMeta_3_suffix("woodwing_file","jpg","psd"),replaceMeta_3_suffix("woodwing_RGB","jpg","psd")}else app.activeDocument.suspendHistory("Freisteller SaveRGB","freisteller_saveRGB()"),app.activeDocument.save()}catch(e){}}app.activeDocument.suspendHistory("toogleOpenCloseSet_byArray_loop","toogleOpenCloseSet_byArray_loop(start_closedSets)"),layer_selectedIDX_set(e)}function toogleOpenCloseSet_byArray_loop(e){for(var r=0;r<e.length;r++)try{if(gotoLayer(e[r]),myALayerIDX=getActiveLayerIndex(),myGroupP=app.activeDocument.activeLayer,isLayerSet(myALayerIDX))getNbOfChilds()>1&&(isSetOpened1(myGroupP)?closeGroup(myGroupP):openGroup1(myGroupP));else{myGroupP=app.activeDocument.activeLayer.parent;try{app.activeDocument.activeLayer=myGroupP}catch(e){return}getNbOfChilds()>1&&"Document"!=myGroupP.typename&&(isSetOpened1(myGroupP)?closeGroup(myGroupP):openGroup1(myGroupP))}}catch(e){alert("toogleOpenCloseSet_byArray_loop: "+e)}}function closeDoc(e){try{app.documents.getByName(decodeURI(e)).close(SaveOptions.DONOTSAVECHANGES)}catch(r){ssDebug&&alert("closeDoc: "+e+" :--: "+r)}}function BridgeTalkMessage_openDocID(e,r,t){var a=new BridgeTalk;a.target="indesign",a.body=runID.toSource()+"('"+e+"','"+r+"','"+t+"');",a.onResult=function(e){},a.send(10)}function runID(e,r,t){try{if(function(e){for(var r=!1,t=0;t<app.documents.length;t++)if(-1!==app.documents[t].name.indexOf(e)){r=!0,app.activeDocument=app.documents[t];break}return r}(e))app.activeDocument.links.itemByName(r).editOriginal();else alert("kein Focus auf der Datei?")}catch(e){}return" "}function freisteller_createGroup(){var e=layer_selectedIDX_get();selectLayers("selectAllLayers"),createGroup("Freisteller","passThrough","none",100,t);try{isSelectionActive()&&maskFromSelection()}catch(e){}toogleOpenCloseSet();var r=app.activeDocument.layerSets.getByName("Freisteller");createColorLayer("Freisteller helper","normal","none",100,"none",128,128,128),hide(),app.activeDocument.activeLayer.move(r,ElementPlacement.PLACEAFTER),layer_selectedIDX_set(e)}function freisteller_deFrei(){try{if(app.activeDocument.layerSets.getByName("Freisteller")){var e=layer_selectedID_get();try{var r=!1;if(getMeta_3("isWoodwing"))r=Boolean(getMeta_3("isWoodwing"));try{gotoLayer("Freisteller"),ungroup(),gotoLayer("Freisteller helper"),deleteActiveLayer()}catch(e){}if(r){if(getMeta_3("woodwing_RGB"))var a=getMeta_3("woodwing_RGB");if(getMeta_3("woodwing_file"))var o=getMeta_3("woodwing_file");if(getMeta_3("idDocName"))var n=getMeta_3("idDocName");BridgeTalkMessage_openDocID(n,o,!1),replaceMeta_3_suffix("woodwing_file","psd","jpg"),replaceMeta_3_suffix("woodwing_RGB","psd","jpg"),saveMultiformat(new File(a),"jpg",t,RZ_qualityJPG,f,f)}else{var i=new Folder(doc.path),l=GetFileNameOnly(doc.name),c=/(?:\.([^.]+))?$/.exec(doc.name)[1],s=new File(i+"/"+l+"-frei."+c);s.exists&&s.remove()}}catch(e){alert(e)}layer_selectedID_set(e)}}catch(e){return alert("Abbruch!\nkeine Ebene names 'Freisteller' gefunden\n"+e),!1}}function BridgeTalkMessage_openDocID(e,r,t){var a=new BridgeTalk;a.target="indesign",a.body=runID.toSource()+"('"+e+"','"+r+"','"+t+"');",a.onResult=function(e){},a.send(10)}function runID(e,r,t){try{if(function(e){for(var r=!1,t=0;t<app.documents.length;t++)if(-1!==app.documents[t].name.indexOf(e)){r=!0,app.activeDocument=app.documents[t];break}return r}(e))app.activeDocument.links.itemByName(r).editOriginal();else alert("kein Focus auf der Datei?")}catch(e){}return" "}function freisteller_reduce2layers(){try{doc.layers.getByName("Freisteller helper")&&hide("Freisteller helper")}catch(e){}try{selectLayers("selectAllLayers"),selectLayerBySelector("Freisteller","remove"),layer_mergeLayers();var e=checkTransparency_inner();if(e){moveLayer3("down",1);var r=layer_selectedID_get()}else layer_makeBackground();if(dublicate("frei"),copypaste_LayerFX("Freisteller","frei"),e){createColorLayer("Weiss","normal","none",100,"none",255,255,255),moveLayer3("back",1);for(var t=0;t<r.length;t++)selectLayerByID(r[t],"add");layer_mergeLayers(),layer_makeBackground()}gotoLayer("Freisteller"),fixMask(getActiveLayerIndex(),1);var a=getMaskVisibility();loadSelectionOfMask(),gotoLayer("frei");try{isSelectionActive()&&maskFromSelection()}catch(e){}layer_delete("Freisteller"),a?(makeVisible("frei"),hide(0),gotoLayer("frei")):(makeVisible(0),hide("frei"),gotoLayer(0))}catch(e){alert("Error freisteller_reduce2layers: \n"+e)}}function freisteller_saveRGB(){var e=layer_selectedIDX_get(),r=null;if(gotoLayer("Freisteller"),hasLayerMask()){var a=getMaskVisibility();if(setMaskVisibility(!0),"Freisteller helper"==getLayerName(1)){r=isVisibleIDX(1);makeVisByIndex(1,!1)}var o=app.activeDocument.path+"/"+GetFileNameOnly(app.activeDocument.name)+"-frei";savePSD_v2(new File(o),t,t,t,f),setMaskVisibility(!1),null!=r&&makeVisByIndex(1,r),setMaskVisibility(a)}layer_selectedIDX_set(e)}function himmelmaske(e,r){var t=layer_selectedIDX_get();cancel=!1,selection_loop((function(){select_sky(!1)})),cancel||("Selection"==r?(layer_selectedIDX_set(t),"nicht Himmel"==e&&select_invert()):(gotoLayer(t[t.length-1]),selection2mask(e),"nicht Himmel"==e&&(gotoMask(),invert(),gotoFill())))}function motivmaske(e,r){var t=layer_selectedIDX_get();cancel=!1,selection_loop((function(){select_motiv()})),cancel||("Selection"==r?(layer_selectedIDX_set(t),"nicht Motiv"==e&&select_invert()):(gotoLayer(t[t.length-1]),selection2mask(e),"nicht Motiv"==e&&(gotoMask(),invert(),gotoFill())))}function startschuss(e,r){debug&&time_start(),indexcolor2rgb(),noProfile(),gray2rgb(),cmyk2rgb(),sRGB2eciRGB(),8!=getBitDepth()&&dialog_bitdepth(),debug&&alert("imageDimension"+String.fromCharCode(13)+"[0] top_distance: "+e[0]+String.fromCharCode(13)+"[1] right_distance: "+e[1]+String.fromCharCode(13)+"[2] bottom_distance: "+e[2]+String.fromCharCode(13)+"[3] left_distance: "+e[3]+String.fromCharCode(13)+"[4] outer_width: "+e[4]+String.fromCharCode(13)+"[5] outer_height: "+e[5]+String.fromCharCode(13)+"[6] inner_width: "+e[6]+String.fromCharCode(13)+"[7] inner_height: "+e[7]+String.fromCharCode(13)+"[8] outerTL: "+e[8]+String.fromCharCode(13)+"[9] outerTR: "+e[9]+String.fromCharCode(13)+"[10] outerBR: "+e[10]+String.fromCharCode(13)+"[11] outerBL: "+e[11]+String.fromCharCode(13)+"[12] outerTL: "+e[12]+String.fromCharCode(13)+"[13] outerTR: "+e[13]+String.fromCharCode(13)+"[14] outerBR: "+e[14]+String.fromCharCode(13)+"[15] outerBL: "+e[15]+String.fromCharCode(13)+"[16] innerTL: "+e[16]+String.fromCharCode(13)+"[17] innerTR: "+e[17]+String.fromCharCode(13)+"[18] innerBR: "+e[18]+String.fromCharCode(13)+"[19] innerBL: "+e[19]+String.fromCharCode(13)+"[20] innerTL: "+e[20]+String.fromCharCode(13)+"[21] innerTR: "+e[21]+String.fromCharCode(13)+"[22] innerBR: "+e[22]+String.fromCharCode(13)+"[23] innerBL: "+e[23]+String.fromCharCode(13)+"[24] orientation: "+e[24]+String.fromCharCode(13)+"[25] distance_topL: "+e[25]+String.fromCharCode(13)+"[26] distance_topR: "+e[26]+String.fromCharCode(13)+"[27] distance_rightT:"+e[27]+String.fromCharCode(13)+"[28] distance_rightB:"+e[28]+String.fromCharCode(13)+"[29] distance_bottomR:"+e[29]+String.fromCharCode(13)+"[30] distance_bottomL:"+e[30]+String.fromCharCode(13)+"[31] distance_leftB:"+e[31]+String.fromCharCode(13)+"[32] distance_leftT:"+e[32]+String.fromCharCode(13)+"[33] _image.rotationAngle:"+e[33]+String.fromCharCode(13)+"[34] Druckbogen TL x-Achse: "+e[34]+String.fromCharCode(13)+"[35] Druckbogen TL y-Achse:"+e[35]+String.fromCharCode(13)+"[36] Druckbogen BR x-Achse - Höhe:"+e[36]+String.fromCharCode(13)+"[37] Druckbogen BR y-Achse - Breite:"+e[37]+String.fromCharCode(13)+"[38] spreadMoveX:"+e[38]+String.fromCharCode(13)+"[39] spreadMoveY:"+e[39]+String.fromCharCode(13)+"[40] Breite des Druckbogens:"+e[40]+String.fromCharCode(13)+"[41] Höhe des Druckbogens:"+e[41]+String.fromCharCode(13)+"[42] pageMoveX:"+e[42]+String.fromCharCode(13)+"[43] pageMoveY:"+e[43]);try{if(void 0!==r&&null!=r&&null!=r.length&&r.length>0&&r[0][0])for(var a=0;a<r.length;a++){var o=r[a];if(hasBackground())n=o[1];else var n=o[1]+=1;var i=o[0],l=getLayerName(n),c=o[2],s=o[3];c!=s&&i==l&&(s?makeVisible(n):hide(n))}}catch(e){debug&&alert("Error startschuss layerOptions: "+e)}try{"undefined"!=typeof myPsDoc&&setSize("width",e[6],"points")}catch(e){debug&&alert("error startschuss setSize: "+e)}try{if(hasBackground()&&0!=getActiveLayerIndex()){var d=doc.activeLayer.name;gotoLayer(0),nameLayer("HG"),gotoLayer(d);d=""}}catch(e){debug&&alert("error startschuss hasBackground: "+e)}nameLayer("Original");try{void 0!==e&&(0===e[0]&&0===e[1]&&0===e[2]&&0===e[3]||(0===e[3]&&0===e[0]||k(e[3],e[0],Units.POINTS,AnchorPosition.BOTTOMRIGHT),0===e[1]&&0===e[2]||k(e[1],e[2],Units.POINTS,AnchorPosition.TOPLEFT),createColorLayer("Anbau","normal","none",100,"none",128,128,128),moveLayer3("down",1),selectLayers("selectAllLayers")))}catch(e){debug&&alert(alert("error startschuss _imageDimension: "+e))}selectLayers("selectAllLayers"),smartObject(),nameLayer("Original"),createGroup("vorher","passThrough","none",100,t),dublicate("nachher"),gotoLayer("vorher"),selectLayer("down",1),nameLayer("vorher Ebene"),rasterSmartObject(),toogleOpenCloseSet(),selectLayer("up",1),createColorLayer("Weiss","normal","none",100,"none",255,255,255),moveLayer("Weiss","Original","down"),createGroup("Einstellungen","passThrough","none",100,f),createLayer("AutoTonwert","levels","normal","gray",100,"none",f,t),toogleVisibility(),createLayer("Gradation neutral","curves","normal","gray",100,"none",f,f),DodgeBurn_highmidlow(!0),selectLayer("up",1),createLayer("Selektive Farbe","selectiveColor","normal","violet",100,"",f,f),createLayer("Sättigung Farbe","hueSaturation","normal","blue",100,"",f,f),createLayer("Sättigung Luminanz","hueSaturation","luminosity","green",100,"",f,f),createLayer("Farbe in Balance","colorBalance","normal","yellowColor",100,"",f,f),createLayer("Gradation Kontrast","curves","normal","orange",100,"",f,f),createLayer("Dynamik","vibrance","normal","red",100,"",f,f);try{if(void 0!==e){startRulerUnits=app.preferences.rulerUnits,app.preferences.rulerUnits=Units.POINTS,createGroup("Layout","passThrough","none",100,f),layer_shape_create("rectangle",0,0,e[5]/doc.height.value*100,e[4]/doc.width.value*100,!1,[255,255,255],!0,[0,255,255],2,"strokeStyleAlignOutside");var g=-1*(m=e[16],_=e[20],h=e[17],L=e[21],v=L-_,C=h-m,Math.atan2(v,C)*(180/Math.PI)),y=-1*e[32]+e[3],u=-1*e[25]+e[0];if(6==e[24])g=g+90;if(8==e[24])g=g-90;if(0!=e[33])g=g-e[33];layer_transform("topleft",0,0,void 0,void 0,void 0,t,"distanceUnit",g),layer_transform("midcenter",y,u,void 0,void 0,void 0,t,"distanceUnit",0);var p=Math.round(100*g)/100;try{p=p.replace(".",",")}catch(e){}nameLayer("Beschnitt ["+p+"°]"),layer_shape_create("rectangle",0,0,e[41]/doc.height.value*100,e[40]/doc.width.value*100,!1,[255,255,255],!0,[255,0,255],2,"strokeStyleAlignOutside"),layer_transform("topleft",0,0,void 0,void 0,void 0,t,"distanceUnit",g),layer_transform("midcenter",e[37]/-2+-1*e[39]+(e[37]/2+e[42]),e[36]/-2+-1*e[38]+(e[36]/2+e[43]),void 0,void 0,void 0,t,"distanceUnit",0),nameLayer("Ansicht ["+p+"°]"),toogleOpenCloseSet(),moveLayer("Layout","Einstellungen","up"),app.preferences.rulerUnits=startRulerUnits}}catch(e){}var m,_,h,L,v,C;function k(e,r,t,a){startRulerUnits=app.preferences.rulerUnits,app.preferences.rulerUnits=t;var o=doc.width.value+e,n=doc.height.value+r;doc.resizeCanvas(o,n,a),app.preferences.rulerUnits=startRulerUnits}gotoLayer("Gradation neutral"),debug&&time_stop(start)}function tiefenmaske(e,r,t){var a=layer_selectedIDX_get();if(cancel=!1,e)layer_mergeVisible(e);else{if("LayerKind.SMARTOBJECT"!=doc.activeLayer.kind&&"LayerKind.NORMAL"!=doc.activeLayer.kind)return void alert("Abruch\n Eine Tiefenmakse von dieser Ebene kann nciht erstellt werden.");layer_copyLayers(),"LayerKind.SMARTOBJECT"==doc.activeLayer.kind&&rasterSmartObject(),layer_selectedIDX_get().length>1&&layer_mergeLayers()}nameLayer("helper__depthMask_image");for(var o=hasBackground()?0:1;layer_checkExistence(o);)o++;moveLayer("helper__depthMask_image",parseInt(o-1),"up"),gotoLayer("helper__depthMask_image"),selection_loop((function(){neural_depthmap2()})),nameLayer("layer__depthMask_map"),select_luminance(),layer_delete(),gotoLayer("helper__depthMask_image"),layer_delete(),cancel||("Selection"==t?(layer_selectedIDX_set(a),"nicht Tiefe"==r&&select_invert()):(gotoLayer(a[a.length-1]),selection2mask(r),"nicht Tiefe"==r&&(gotoMask(),invert(),gotoFill())))}function tiefenmakse_part1(e){layer_selectedIDX_get();if(e||layer_selectedIDX_get().length>1){e?layer_mergeVisible(e):(layer_copyLayers(),layer_mergeLayers()),nameLayer("helper__depthMask_image");for(var r=hasBackground()?0:1;layer_checkExistence(r);)r++;moveLayer("helper__depthMask_image",parseInt(r-1),"up"),gotoLayer("helper__depthMask_image")}else{for(layer_checkExistence(layer_getIDXbyString("Original")[0])?gotoLayer("Original"):gotoLayer(layer_selectedIDX_get()[layer_selectedIDX_get().length-1]);doc.activeLayer.kind!=LayerKind.NORMAL;)gotoLayer(getActiveLayerIndex()-1);doc.activeLayer.kind!=LayerKind.SmartObject&&(executeAction(sTID("copyToLayer"),void 0,DialogModes.NO),nameLayer("helper__depthMask_image"))}}function tiefenmakse_part2(e){nameLayer("layer__depthMask_map"),select_luminance(),layer_delete(),gotoLayer("helper__depthMask_image"),layer_delete(),createGroup("Tiefe","passThrough","none",100,f),maskFromSelection(),layer_checkExistence(layer_getIDXbyString("Dodge & Burn △◊▽")[0])&&moveLayer("Tiefe","Dodge & Burn △◊▽","up"),gotoLayer("Tiefe")}