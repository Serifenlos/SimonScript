function channel2mask(e,n){for(var t=1;layer_checkExistence(layer_getIDXbyString(n+" "+t)[0]);)t++;createGroup(n+" "+t,"passThrough","none",100,f),createMask(),channel_select(e,!1),select_all(),copy(),channel_select("mask",!0),paste_into(),channel_select("RGB",!1),selection_deselect()}function channel2selection(e){var n=new ActionDescriptor,t=new ActionReference,a=new ActionReference;t.putProperty(s2t("channel"),s2t("selection")),n.putReference(s2t("null"),t),a.putName(s2t("channel"),e),n.putReference(s2t("to"),a),executeAction(s2t("set"),n,DialogModes.NO)}function channel_delete(e){var n=new ActionDescriptor,t=new ActionReference;t.putName(s2t("channel"),e),n.putReference(s2t("null"),t),executeAction(s2t("delete"),n,DialogModes.NO)}function channel_name(e){var n=new ActionDescriptor,t=new ActionDescriptor,a=new ActionReference;a.putEnumerated(s2t("channel"),s2t("ordinal"),s2t("targetEnum")),n.putReference(s2t("null"),a),t.putString(s2t("name"),e),n.putObject(s2t("to"),s2t("channel"),t),executeAction(s2t("set"),n,DialogModes.NO)}function channel_select(e,n){var t=new ActionDescriptor,a=new ActionReference;e&&("red"==e||"grain"==e||"blue"==e||"RGB"==e||"mask"==e||"cyan"==e||"magenta"==e||"yellow"==e||"black"==e||"CMYK"==e||"lightness"==e||"a"==e||"b"==e||"lab"==e?a.putEnumerated(s2t("channel"),s2t("channel"),s2t(e)):a.putName(s2t("channel"),e),t.putReference(s2t("null"),a),t.putBoolean(s2t("makeVisible"),n),executeAction(s2t("select"),t,DialogModes.NO))}function channel_setSaturation(e,n){var t="difference";kanalberechnung("red",f,"grain",f,e,t,"rg","RGB"),kanalberechnung("red",f,"blue",f,e,t,"rb","RGB"),kanalberechnung("rg",f,"rb",f,"this",n,"R","RGB"),channel_delete("rg"),channel_delete("rb"),kanalberechnung("grain",f,"red",f,e,t,"gr","RGB"),kanalberechnung("grain",f,"blue",f,e,t,"gb","RGB"),kanalberechnung("gr",f,"gb",f,"this",n,"G","RGB"),channel_delete("gr"),channel_delete("gb"),kanalberechnung("blue",f,"red",f,e,t,"br","RGB"),kanalberechnung("blue",f,"grain",f,e,t,"bg","RGB"),kanalberechnung("br",f,"bg",f,"this",n,"B","RGB"),channel_delete("br"),channel_delete("bg"),kanalberechnung("R",f,"G",f,"this",n,"RG","RGB"),kanalberechnung("RG",f,"B",f,"this",n,"saturation","RGB"),channel_delete("R"),channel_delete("G"),channel_delete("B"),channel_delete("RG")}function channel_setSaturation_singleColors(e,n){var a="subtract";kanalberechnung("red",t,"grain",t,e,a,"rg","RGB"),kanalberechnung("red",t,"blue",t,e,a,"rb","RGB"),kanalberechnung("grain",t,"red",t,e,a,"gr","RGB"),kanalberechnung("grain",t,"blue",t,e,a,"gb","RGB"),kanalberechnung("blue",t,"red",t,e,a,"br","RGB"),kanalberechnung("blue",t,"grain",t,e,a,"bg","RGB"),kanalberechnung("rg",f,"rb",f,"this",n,"R","RGB"),kanalberechnung("br",f,"bg",f,"this",n,"B","RGB"),kanalberechnung("gb",f,"gr",f,"this",n,"G","RGB"),kanalberechnung("gb",f,"gr",f,"this",a,"C","RGB"),kanalberechnung("br",f,"bg",f,"this",a,"M","RGB"),kanalberechnung("rg",f,"rb",f,"this",a,"Y","RGB"),kanalberechnung("R",f,"Y",f,"this",n,"RY","RGB"),kanalberechnung("Y",f,"G",f,"this",n,"YG","RGB"),kanalberechnung("G",f,"C",f,"this",n,"GC","RGB"),kanalberechnung("C",f,"B",f,"this",n,"CB","RGB"),kanalberechnung("B",f,"M",f,"this",n,"BM","RGB")}function kanalberechnung(e,n,t,a,l,r,c,s){var o=new ActionDescriptor,i=new ActionDescriptor,u=(new ActionDescriptor,new ActionReference),h=new ActionReference;new ActionReference;o.putClass(s2t("new"),s2t("channel")),"red"==e||"grain"==e||"blue"==e||"gray"==e?u.putEnumerated(s2t("channel"),s2t("channel"),s2t(e)):u.putName(s2t("channel"),e),"merged"==l?u.putEnumerated(s2t("layer"),s2t("ordinal"),s2t("merged")):"this"!=l&&u.putName(s2t("layer"),l),i.putReference(s2t("to"),u),i.putBoolean(s2t("invert"),n),i.putEnumerated(s2t("calculation"),s2t("calculationType"),s2t(r)),"red"==t||"grain"==t||"blue"==t||"gray"==t?h.putEnumerated(s2t("channel"),s2t("channel"),s2t(t)):h.putName(s2t("channel"),t),"merged"==l?h.putEnumerated(s2t("layer"),s2t("ordinal"),s2t("merged")):"this"!=l&&h.putName(s2t("layer"),l),i.putReference(s2t("source2"),h),i.putBoolean(s2t("invertSource2"),a),o.putObject(s2t("using"),s2t("calculation"),i),executeAction(s2t("make"),o,DialogModes.NO),channel_name(c),channel_select(s,!1)}function mask_setSaturation_singleColors(e){function n(e,n,t,a){selection_deselect(),gotoFill(),channel2selection(e),createColorLayer(e,"multiply","none",100,"xx",n,t,a),gotoFill()}channel_setSaturation_singleColors("merged","darken"),createGroup(e,"passThrough","none",100,f),createColorLayer("Weiss","normal","none",100,"none",255,255,255),n("M",255,0,255),n("BM",127,0,255),n("B",0,0,255),n("CB",0,127,255),n("C",0,255,255),n("GC",0,255,127),n("G",0,255,0),n("YG",127,255,0),n("Y",255,255,0),n("RY",255,127,0),n("R",255,0,0),createLayer("Maske Preview","colorLookup","normal","none",100,"none",f,f),LUT_maske_preview(),createLayer("Maske Gradation","curves","normal","none",100,"none",f,f),channel_delete("rg"),channel_delete("rb"),channel_delete("gr"),channel_delete("gb"),channel_delete("br"),channel_delete("bg"),channel_delete("R"),channel_delete("G"),channel_delete("B"),channel_delete("C"),channel_delete("M"),channel_delete("Y"),channel_delete("RY"),channel_delete("YG"),channel_delete("GC"),channel_delete("CB"),channel_delete("BM")}function mask_setSaturation_singleColors_create(e){if(layer_checkExistence(e))select_luminance(),layer_delete(e),layer_selectedID_set(getMeta_2("startID")),delMeta_2("startID");else{if(setMeta_2("startID",layer_selectedID_get()),selection_loop((function(){mask_setSaturation_singleColors(e)})),gotoLayer(e),layer_checkExistence("nachher"))moveLayer(e,"nachher","up"),gotoLayer(e),moveLayer3("down",1);else{for(var n=hasBackground()?0:1;layer_checkExistence(n);)n++;moveLayer(e,parseInt(n-1),"up")}layer_selectedID_set(getMeta_2("startID"))}}