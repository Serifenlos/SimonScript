function cTID(e){return app.charIDToTypeID(e)}function sTID(e){return app.stringIDToTypeID(e)}
/* saving/restoring preferences */
function prefSave(){startDisplayDialogs=app.displayDialogs,startRulerUnits=app.preferences.rulerUnits}function prefSet(){app.displayDialogs=DialogModes.NO,app.preferences.rulerUnits=Units.CM}function prefReset(){app.preferences.rulerunits=startRulerUnits,startDisplayDialogs==DialogModes.ERROR&&(startDisplayDialogs=DialogModes.NO),app.displayDialogs=startDisplayDialogs}function createLayer(e,t,n,s,r){var o=new ActionDescriptor,c=new ActionReference;c.putClass(sTID("adjustmentLayer")),o.putReference(sTID("null"),c);var a=new ActionDescriptor;if(a.putString(sTID("name"),n),a.putEnumerated(sTID("mode"),sTID("blendMode"),sTID(t)),a.putEnumerated(sTID("color"),sTID("color"),sTID(s)),"levels"==e&&r){var i=new ActionDescriptor;i.putEnumerated(sTID("presetKind"),sTID("presetKindType"),sTID("presetKindDefault"));var D=new ActionList,u=new ActionDescriptor,p=new ActionReference;p.putEnumerated(sTID("channel"),sTID("channel"),sTID("composite")),u.putReference(sTID("channel"),p),u.putBoolean(sTID("auto"),!0),D.putObject(sTID("levelsAdjustment"),u),i.putList(sTID("adjustment"),D),a.putObject(sTID("type"),sTID(e),i)}else a.putClass(sTID("type"),sTID(e));o.putObject(sTID("using"),sTID("adjustmentLayer"),a),executeAction(sTID("make"),o,DialogModes.NO)}function createColorLayer(e,t,n,s,r,o){var c=new ActionDescriptor,a=new ActionReference;a.putClass(sTID("contentLayer")),c.putReference(sTID("null"),a);var i=new ActionDescriptor;i.putString(sTID("name"),t),i.putEnumerated(sTID("mode"),sTID("blendMode"),sTID(e)),i.putEnumerated(sTID("color"),sTID("color"),sTID(n));var D=new ActionDescriptor,u=new ActionDescriptor;u.putDouble(sTID("red"),s),u.putDouble(sTID("green"),r),u.putDouble(sTID("blue"),o),D.putObject(sTID("color"),sTID("RGBColor"),u),i.putObject(sTID("type"),sTID("solidColorLayer"),D),c.putObject(sTID("using"),sTID("contentLayer"),i),executeAction(sTID("make"),c,DialogModes.NO)}function deleteMask(){try{var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("channel"),sTID("channel"),sTID("mask")),e.putReference(sTID("null"),t),executeAction(sTID("delete"),e,DialogModes.NO)}catch(e){}}function noProfile(){
// if image has no profile -> assign a Profile
if(doc.colorProfileType==ColorProfile.NONE)try{var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("document"),sTID("ordinal"),sTID("targetEnum")),e.putReference(sTID("null"),t),e.putBoolean(sTID("manage"),!0),executeAction(sTID("assignProfile"),e,DialogModes.ALL)}catch(e){}}function createGroup(e){var t=new ActionDescriptor,n=new ActionReference;n.putClass(sTID("layerSection")),t.putReference(cTID("null"),n);var s=new ActionDescriptor;s.putString(cTID("Nm  "),e),t.putObject(cTID("Usng"),sTID("layerSection"),s),executeAction(cTID("Mk  "),t,DialogModes.NO)}function smartObject(){executeAction(stringIDToTypeID("newPlacedLayer"),void 0,DialogModes.NO)}function nameLayer(e){doc.activeLayer.name=e}function selectLayerUp(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("layer"),sTID("ordinal"),sTID("forwardEnum")),e.putReference(sTID("null"),t),e.putBoolean(sTID("makeVisible"),!1);var n=new ActionList;n.putInteger(108),e.putList(sTID("layerID"),n),executeAction(sTID("select"),e,DialogModes.NO)}doc=app.activeDocument;