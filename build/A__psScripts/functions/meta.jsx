function delMeta(){editXMP(),xmpMeta.deleteProperty(customNamespace,"proof_profil"),xmpMeta.deleteProperty(customNamespace,"proof_intent"),xmpMeta.deleteProperty(customNamespace,"proof_tk"),app.activeDocument.xmpMetadata.rawData=xmpMeta.serialize()}function delMeta_2(e){editXMP_2(),xmpMeta.doesPropertyExist(customNamespace2,e)&&xmpMeta.deleteProperty(customNamespace2,e),app.activeDocument.xmpMetadata.rawData=xmpMeta.serialize()}function delMeta_3(e){editXMP_3(),xmpMeta.doesPropertyExist(ns_ss,e)&&xmpMeta.deleteProperty(ns_ss,e),app.activeDocument.xmpMetadata.rawData=xmpMeta.serialize()}function editXMP(){null==ExternalObject.AdobeXMPScript&&(ExternalObject.AdobeXMPScript=new ExternalObject("lib:AdobeXMPScript")),xmpMeta=new XMPMeta(app.activeDocument.xmpMetadata.rawData),customNamespace="http://ns.simonadrian.de/proofsetup/1.0",customPrefix="proofsetup:",XMPMeta.registerNamespace(customNamespace,customPrefix)}function editXMP_2(e,t){null==ExternalObject.AdobeXMPScript&&(ExternalObject.AdobeXMPScript=new ExternalObject("lib:AdobeXMPScript")),xmpMeta=new XMPMeta(app.activeDocument.xmpMetadata.rawData),customNamespace2=e?customNamespace2:"http://ns.simonadrian.de/1.0",customPrefix2=t?customPrefix2:"simonscript:",XMPMeta.registerNamespace(customNamespace2,customPrefix2)}function editXMP_3(e,t){null==ExternalObject.AdobeXMPScript&&(ExternalObject.AdobeXMPScript=new ExternalObject("lib:AdobeXMPScript")),xmpMeta=new XMPMeta(app.activeDocument.xmpMetadata.rawData),ns_ss=e?ns_ss:"http://ns.simonadrian.de/simonscript/1.0/",ns_ssPrefix=t?ns_ssPrefix:"ss:",XMPMeta.registerNamespace(ns_ss,ns_ssPrefix)}function getMeta(){if(editXMP(),xmpMeta.doesPropertyExist(customNamespace,"proof_profil"))xmpMeta.getProperty(customNamespace,"proof_profil");if(xmpMeta.doesPropertyExist(customNamespace,"proof_intent"))xmpMeta.getProperty(customNamespace,"proof_intent");if(xmpMeta.doesPropertyExist(customNamespace,"proof_tk"))xmpMeta.getProperty(customNamespace,"proof_tk")}function getMeta_2(e){if(editXMP_2(),xmpMeta.doesPropertyExist(customNamespace2,e))var t=xmpMeta.getProperty(customNamespace2,e);if(void 0!==t)return t}function getMeta_3(e){if(editXMP_3(),xmpMeta.doesPropertyExist(ns_ss,e))var t=xmpMeta.getProperty(ns_ss,e);if(void 0!==t)return t}function getMeta_softproof(){editXMP();const e=[];if(xmpMeta.doesPropertyExist(customNamespace,"proof_profil"))var t=xmpMeta.getProperty(customNamespace,"proof_profil");if(xmpMeta.doesPropertyExist(customNamespace,"proof_intent"))var a=xmpMeta.getProperty(customNamespace,"proof_intent");if(xmpMeta.doesPropertyExist(customNamespace,"proof_tk"))var o=xmpMeta.getProperty(customNamespace,"proof_tk");return e.push(t,a,o),e}function getSoftProof(){var e=new ActionReference,t=new ActionDescriptor;e.putEnumerated(stringIDToTypeID("application"),stringIDToTypeID("ordinal"),stringIDToTypeID("targetEnum")),t.putReference(stringIDToTypeID("target"),e);var a=executeAction(stringIDToTypeID("proofSetup"),t,DialogModes.NO);a.getString(stringIDToTypeID("profile"))&&(proofProfil=a.getString(stringIDToTypeID("profile"))),typeIDToStringID(a.getEnumerationValue(s2t("intent")))&&(proofIntent=typeIDToStringID(a.getEnumerationValue(s2t("intent")))),a.getBoolean(stringIDToTypeID("mapBlack"))&&(proofTK=a.getBoolean(stringIDToTypeID("mapBlack")))}function set(){var e=new ActionDescriptor;e.putString(stringIDToTypeID("profile"),"PSO MFC Paper (ECI)"),e.putEnumerated(stringIDToTypeID("intent"),stringIDToTypeID("intent"),stringIDToTypeID("colorimetric")),e.putBoolean(stringIDToTypeID("mapBlack"),!1),alert(e.getString(stringIDToTypeID("profile"))+"\n"+typeIDToStringID(e.getEnumerationValue(s2t("intent")))+"\n"+e.getBoolean(stringIDToTypeID("mapBlack"))),executeAction(stringIDToTypeID("proofSetup"),e,DialogModes.NO)}function setMeta(){getSoftProof(),editXMP(),xmpMeta.setProperty(customNamespace,"proof_profil",proofProfil),xmpMeta.setProperty(customNamespace,"proof_intent",proofIntent),xmpMeta.setProperty(customNamespace,"proof_tk",proofTK),app.activeDocument.xmpMetadata.rawData=xmpMeta.serialize()}function setMeta_2(e,t){editXMP_2(),xmpMeta.doesPropertyExist(customNamespace2,e)&&xmpMeta.deleteProperty(customNamespace2,e),xmpMeta.setProperty(customNamespace2,e,t),app.activeDocument.xmpMetadata.rawData=xmpMeta.serialize()}function setMeta_3(e,t){editXMP_3(),xmpMeta.doesPropertyExist(ns_ss,e)&&xmpMeta.deleteProperty(ns_ss,e),xmpMeta.setProperty(ns_ss,e,t),app.activeDocument.xmpMetadata.rawData=xmpMeta.serialize()}