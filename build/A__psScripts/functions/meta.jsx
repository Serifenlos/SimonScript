function set(){var e=new ActionDescriptor;e.putString(stringIDToTypeID("profile"),"PSO MFC Paper (ECI)"),e.putEnumerated(stringIDToTypeID("intent"),stringIDToTypeID("intent"),stringIDToTypeID("colorimetric")),e.putBoolean(stringIDToTypeID("mapBlack"),!1),alert(e.getString(stringIDToTypeID("profile"))+"\n"+typeIDToStringID(e.getEnumerationValue(s2t("intent")))+"\n"+e.getBoolean(stringIDToTypeID("mapBlack"))),executeAction(stringIDToTypeID("proofSetup"),e,DialogModes.NO)}function getSoftProof(){var e=new ActionReference,t=new ActionDescriptor;e.putEnumerated(stringIDToTypeID("application"),stringIDToTypeID("ordinal"),stringIDToTypeID("targetEnum")),t.putReference(stringIDToTypeID("target"),e);var o=executeAction(stringIDToTypeID("proofSetup"),t,DialogModes.NO);o.getString(stringIDToTypeID("profile"))&&(proofProfil=o.getString(stringIDToTypeID("profile"))),typeIDToStringID(o.getEnumerationValue(s2t("intent")))&&(proofIntent=typeIDToStringID(o.getEnumerationValue(s2t("intent")))),o.getBoolean(stringIDToTypeID("mapBlack"))&&(proofTK=o.getBoolean(stringIDToTypeID("mapBlack")))}function editXMP(){null==ExternalObject.AdobeXMPScript&&(ExternalObject.AdobeXMPScript=new ExternalObject("lib:AdobeXMPScript")),xmpMeta=new XMPMeta(app.activeDocument.xmpMetadata.rawData),customNamespace="http://ns.simonadrian.de/proofsetup/1.0",customPrefix="proofsetup:",XMPMeta.registerNamespace(customNamespace,customPrefix)}function setMeta(){getSoftProof(),editXMP(),xmpMeta.setProperty(customNamespace,"proof_profil",proofProfil),xmpMeta.setProperty(customNamespace,"proof_intent",proofIntent),xmpMeta.setProperty(customNamespace,"proof_tk",proofTK),app.activeDocument.xmpMetadata.rawData=xmpMeta.serialize()}function delMeta(){editXMP(),xmpMeta.deleteProperty(customNamespace,"proof_profil"),xmpMeta.deleteProperty(customNamespace,"proof_intent"),xmpMeta.deleteProperty(customNamespace,"proof_tk"),app.activeDocument.xmpMetadata.rawData=xmpMeta.serialize()}function getMeta(){editXMP(),xmpMeta.doesPropertyExist(customNamespace,"proof_profil")&&xmpMeta.getProperty(customNamespace,"proof_profil"),xmpMeta.doesPropertyExist(customNamespace,"proof_intent")&&xmpMeta.getProperty(customNamespace,"proof_intent"),xmpMeta.doesPropertyExist(customNamespace,"proof_tk")&&xmpMeta.getProperty(customNamespace,"proof_tk")}function s2t(e){return app.stringIDToTypeID(e)}function c2t(e){return app.charIDToTypeID(e)}function t2s(e){return app.typeIDToStringID(e)}function getZoomLevel(){var e=new ActionReference;e.putProperty(stringIDToTypeID("property"),stringIDToTypeID("zoom")),e.putEnumerated(charIDToTypeID("Dcmn"),charIDToTypeID("Ordn"),charIDToTypeID("Trgt"));var t=executeActionGet(e);return Number(100*t.getDouble(stringIDToTypeID("zoom"))).toFixed(1)}function toggleProofColors(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(s2t("menuItemClass"),s2t("menuItemType"),s2t("toggleProofColors")),e.putReference(s2t("null"),t),executeAction(s2t("select"),e,DialogModes.NO)}function toggleProofColors2(){}